<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>太虚仙门 · 问道长生</title>
<script src="https://cdn.tailwindcss.com"></script>
<script>
tailwind.config = {
theme: {
extend: {
colors: {
ink: '#0a0e14',
paper: '#f5f0e6',
vermilion: '#c53d43',
jade: '#5a7e7a',
gold: '#d4a853',
azure: '#4a6fa5',
mystic: '#2d3a4a',
spirit: '#7eb8a2',
cinnabar: '#e34234',
bronze: '#cd7f32',
}
}
}
}
</script>
<link href="https://fonts.googleapis.com/css2?family=Ma+Shan+Zheng&family=Noto+Serif+SC:wght@300;400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
--bg-primary: #0a0e14;
--bg-secondary: #141b24;
--text-primary: #f5f0e6;
--text-secondary: #a8a095;
--accent-gold: #d4a853;
--accent-jade: #5a7e7a;
--glow-gold: rgba(212, 168, 83, 0.5);
}

* { box-sizing: border-box; }
body { 
font-family: 'Noto Serif SC', serif; 
background: var(--bg-primary);
color: var(--text-primary);
overflow-x: hidden;
}

.font-brush { font-family: 'Ma Shan Zheng', cursive; }

/* 动态背景层 */
.bg-layer {
position: fixed;
inset: 0;
z-index: 0;
pointer-events: none;
}

/* 星空背景 */
.stars {
background-image: 
radial-gradient(2px 2px at 20px 30px, #eee, transparent),
radial-gradient(2px 2px at 40px 70px, rgba(255,255,255,0.8), transparent),
radial-gradient(1px 1px at 90px 40px, #fff, transparent),
radial-gradient(2px 2px at 160px 120px, rgba(255,255,255,0.9), transparent),
radial-gradient(1px 1px at 230px 80px, #fff, transparent);
background-size: 250px 250px;
animation: starsTwinkle 5s ease-in-out infinite;
}

@keyframes starsTwinkle {
0%, 100% { opacity: 0.5; }
50% { opacity: 1; }
}

/* 流动灵气 */
@keyframes flowQi {
0% { transform: translateY(0) translateX(0); opacity: 0; }
20% { opacity: 0.6; }
80% { opacity: 0.6; }
100% { transform: translateY(-100vh) translateX(50px); opacity: 0; }
}

.qi-particle {
position: absolute;
width: 4px;
height: 20px;
background: linear-gradient(to top, transparent, var(--accent-jade), transparent);
border-radius: 50%;
filter: blur(1px);
animation: flowQi 8s linear infinite;
}

/* 漂浮符文 */
@keyframes floatRune {
0%, 100% { transform: translateY(0) rotate(0deg); opacity: 0.1; }
50% { transform: translateY(-30px) rotate(180deg); opacity: 0.3; }
}

.rune {
position: absolute;
font-family: 'Ma Shan Zheng', cursive;
color: rgba(212, 168, 83, 0.15);
font-size: 2rem;
animation: floatRune 10s ease-in-out infinite;
}

/* 山水背景 */
.mountain-bg {
position: fixed;
inset: 0;
z-index: 0;
background: 
linear-gradient(180deg, 
rgba(10, 14, 20, 0.8) 0%, 
rgba(20, 27, 36, 0.6) 50%, 
rgba(10, 14, 20, 0.9) 100%),
url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 800'%3E%3Cpath fill='%231a1a1a' d='M0,800 L0,600 Q200,400 400,500 T800,400 T1200,500 L1440,450 L1440,800 Z' opacity='0.3'/%3E%3Cpath fill='%232d3a4a' d='M0,800 L0,650 Q300,500 600,600 T1200,500 L1440,550 L1440,800 Z' opacity='0.2'/%3E%3C/svg%3E");
background-size: cover;
}

/* 云雾层 */
@keyframes driftMist {
0% { transform: translateX(-100%); }
100% { transform: translateX(100vw); }
}

.mist-layer {
position: fixed;
inset: 0;
pointer-events: none;
z-index: 1;
overflow: hidden;
}

.mist {
position: absolute;
width: 200%;
height: 100%;
background: linear-gradient(90deg, 
transparent 0%, 
rgba(90, 126, 122, 0.08) 25%, 
rgba(212, 168, 83, 0.05) 50%, 
rgba(90, 126, 122, 0.08) 75%, 
transparent 100%);
animation: driftMist 80s linear infinite;
}

/* 动画关键帧 */
@keyframes pulseGlow {
0%, 100% { box-shadow: 0 0 20px var(--glow-gold), inset 0 0 20px rgba(212, 168, 83, 0.1); }
50% { box-shadow: 0 0 40px var(--glow-gold), inset 0 0 30px rgba(212, 168, 83, 0.2); }
}

@keyframes rotateSlow {
from { transform: rotate(0deg); }
to { transform: rotate(360deg); }
}

@keyframes breathe {
0%, 100% { transform: scale(1); opacity: 0.8; }
50% { transform: scale(1.1); opacity: 1; }
}

@keyframes fadeInUp {
from { opacity: 0; transform: translateY(30px); }
to { opacity: 1; transform: translateY(0); }
}

@keyframes targetPulse {
0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(212, 168, 83, 0.7); }
70% { transform: scale(1.1); box-shadow: 0 0 0 20px rgba(212, 168, 83, 0); }
100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(212, 168, 83, 0); }
}

.animate-fade-in { animation: fadeInUp 0.8s ease-out forwards; }
.animate-delay-1 { animation-delay: 0.1s; }
.animate-delay-2 { animation-delay: 0.2s; }
.animate-delay-3 { animation-delay: 0.3s; }

/* 太极图 */
.taiji {
width: 120px;
height: 120px;
border-radius: 50%;
background: linear-gradient(to right, #f5f0e6 50%, #1a1a1a 50%);
position: relative;
animation: rotateSlow 20s linear infinite;
}

.taiji::before,
.taiji::after {
content: '';
position: absolute;
width: 60px;
height: 60px;
border-radius: 50%;
}

.taiji::before {
background: #f5f0e6;
top: 0;
left: 50%;
transform: translateX(-50%);
}

.taiji::after {
background: #1a1a1a;
bottom: 0;
left: 50%;
transform: translateX(-50%);
}

/* 金丹效果 */
.golden-core {
width: 80px;
height: 80px;
border-radius: 50%;
background: radial-gradient(circle at 30% 30%, #ffd700, #d4a853, #b8860b);
animation: pulseGlow 3s ease-in-out infinite, breathe 4s ease-in-out infinite;
position: relative;
}

.golden-core::after {
content: '';
position: absolute;
inset: -10px;
border-radius: 50%;
background: radial-gradient(circle, rgba(212, 168, 83, 0.3), transparent 70%);
animation: breathe 3s ease-in-out infinite;
}

/* 玻璃卡片 */
.glass-card {
background: linear-gradient(135deg, 
rgba(20, 27, 36, 0.8) 0%, 
rgba(10, 14, 20, 0.9) 100%);
backdrop-filter: blur(20px);
border: 1px solid rgba(212, 168, 83, 0.2);
border-radius: 16px;
position: relative;
overflow: hidden;
box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}

.glass-card::before {
content: '';
position: absolute;
top: 0;
left: 0;
right: 0;
height: 1px;
background: linear-gradient(90deg, transparent, rgba(212, 168, 83, 0.5), transparent);
}

/* 境界进度条 */
.realm-progress {
height: 8px;
background: rgba(26, 26, 26, 0.5);
border-radius: 4px;
overflow: hidden;
position: relative;
}

.realm-progress-bar {
height: 100%;
background: linear-gradient(90deg, var(--accent-jade), var(--accent-gold));
border-radius: 4px;
transition: width 1s ease-out;
position: relative;
}

.realm-progress-bar::after {
content: '';
position: absolute;
inset: 0;
background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
animation: spiritFlow 2s linear infinite;
background-size: 200% 100%;
}

@keyframes spiritFlow {
0% { background-position: 0% 50%; }
50% { background-position: 100% 50%; }
100% { background-position: 0% 50%; }
}

/* 滚动条 */
::-webkit-scrollbar { width: 6px; }
::-webkit-scrollbar-track { background: var(--bg-secondary); }
::-webkit-scrollbar-thumb { background: var(--accent-jade); border-radius: 3px; }

/* 导航 */
.nav-item {
position: relative;
transition: all 0.3s ease;
}

.nav-item::after {
content: '';
position: absolute;
bottom: -4px;
left: 50%;
width: 0;
height: 2px;
background: var(--accent-gold);
transition: all 0.3s ease;
transform: translateX(-50%);
}

.nav-item:hover::after,
.nav-item.active::after {
width: 100%;
}

/* 按钮 */
.btn-immortal {
background: linear-gradient(135deg, rgba(212, 168, 83, 0.2), rgba(212, 168, 83, 0.1));
border: 1px solid rgba(212, 168, 83, 0.4);
color: var(--accent-gold);
padding: 12px 32px;
border-radius: 8px;
font-weight: 600;
transition: all 0.3s ease;
position: relative;
overflow: hidden;
}

.btn-immortal:hover {
background: linear-gradient(135deg, rgba(212, 168, 83, 0.3), rgba(212, 168, 83, 0.2));
box-shadow: 0 0 30px rgba(212, 168, 83, 0.3);
transform: translateY(-2px);
}

.btn-immortal:active {
transform: translateY(0);
}

/* 输入框 */
.input-immortal {
background: rgba(26, 26, 26, 0.5);
border: 1px solid rgba(90, 126, 122, 0.3);
color: var(--text-primary);
padding: 12px 16px;
border-radius: 8px;
transition: all 0.3s ease;
}

.input-immortal:focus {
outline: none;
border-color: var(--accent-gold);
box-shadow: 0 0 20px rgba(212, 168, 83, 0.2);
}

/* 标签页 */
.tab-btn {
padding: 12px 24px;
color: var(--text-secondary);
border-bottom: 2px solid transparent;
transition: all 0.3s ease;
cursor: pointer;
}

.tab-btn:hover {
color: var(--text-primary);
}

.tab-btn.active {
color: var(--accent-gold);
border-bottom-color: var(--accent-gold);
}

/* 秘籍卡片 */
.scroll-card {
background: linear-gradient(180deg, rgba(245, 240, 230, 0.05), rgba(245, 240, 230, 0.02));
border: 1px solid rgba(212, 168, 83, 0.15);
border-radius: 12px;
padding: 24px;
transition: all 0.4s ease;
position: relative;
}

.scroll-card:hover {
transform: translateY(-4px);
border-color: rgba(212, 168, 83, 0.4);
box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
}

.scroll-card::before {
content: '';
position: absolute;
top: 0;
left: 20px;
right: 20px;
height: 1px;
background: linear-gradient(90deg, transparent, rgba(212, 168, 83, 0.5), transparent);
}

/* 引用样式 */
.quote-block {
border-left: 3px solid var(--accent-gold);
padding-left: 20px;
font-style: italic;
color: var(--text-secondary);
position: relative;
}

.quote-block::before {
content: '"';
position: absolute;
left: -10px;
top: -20px;
font-size: 4rem;
color: rgba(212, 168, 83, 0.2);
font-family: 'Ma Shan Zheng', cursive;
}

/* 隐藏内容 */
.content-section {
display: none;
opacity: 0;
}

.content-section.active {
display: block;
animation: fadeInUp 0.6s ease-out forwards;
}

/* 反应测试 */
.reaction-target {
width: 80px;
height: 80px;
border-radius: 50%;
background: radial-gradient(circle, var(--accent-gold), var(--accent-vermilion));
cursor: pointer;
position: absolute;
display: none;
box-shadow: 0 0 30px rgba(212, 168, 83, 0.5);
animation: targetPulse 1s infinite;
}

/* 记忆游戏 */
.memory-card {
aspect-ratio: 1;
background: linear-gradient(135deg, rgba(45, 58, 74, 0.6), rgba(22, 27, 34, 0.8));
border: 1px solid rgba(212, 168, 83, 0.2);
border-radius: 8px;
cursor: pointer;
transition: all 0.3s ease;
display: flex;
align-items: center;
justify-content: center;
font-size: 1.5rem;
color: transparent;
}

.memory-card.flipped {
background: linear-gradient(135deg, rgba(212, 168, 83, 0.2), rgba(212, 168, 83, 0.1));
color: var(--accent-gold);
border-color: var(--accent-gold);
}

.memory-card.matched {
background: rgba(90, 126, 122, 0.3);
color: var(--accent-jade);
border-color: var(--accent-jade);
}

/* 返回按钮 */
.back-btn {
position: fixed;
bottom: 24px;
right: 24px;
z-index: 100;
width: 50px;
height: 50px;
border-radius: 50%;
background: linear-gradient(135deg, rgba(212, 168, 83, 0.3), rgba(212, 168, 83, 0.1));
border: 1px solid rgba(212, 168, 83, 0.4);
color: var(--accent-gold);
display: flex;
align-items: center;
justify-content: center;
cursor: pointer;
transition: all 0.3s ease;
box-shadow: 0 4px 20px rgba(0,0,0,0.3);
}

.back-btn:hover {
transform: scale(1.1);
box-shadow: 0 0 30px rgba(212, 168, 83, 0.4);
}

/* 修炼日志 */
.practice-log {
max-height: 300px;
overflow-y: auto;
padding-right: 8px;
}

.log-entry {
padding: 12px;
border-radius: 8px;
background: rgba(0,0,0,0.2);
margin-bottom: 8px;
border-left: 3px solid var(--accent-jade);
animation: fadeInUp 0.5s ease-out;
}

/* 响应式 */
@media (max-width: 768px) {
.meditation-timer { font-size: 2.5rem; }
.taiji { width: 80px; height: 80px; }
.golden-core { width: 60px; height: 60px; }
.nav-desktop { display: none; }
.back-btn { width: 40px; height: 40px; bottom: 16px; right: 16px; }
}

@media (min-width: 769px) {
.nav-mobile { display: none; }
}
</style>
</head>
<body class="min-h-screen">
<!-- 动态背景层 -->
<div class="bg-layer stars"></div>
<div class="mountain-bg"></div>
<div class="mist-layer">
<div class="mist"></div>
<div class="mist" style="animation-delay: -40s; top: 30%;"></div>
</div>

<!-- 灵气粒子容器 -->
<div id="particles" class="fixed inset-0 pointer-events-none z-10"></div>

<!-- 漂浮符文 -->
<div id="runes" class="fixed inset-0 pointer-events-none z-5"></div>

<!-- 主容器 -->
<div class="relative z-20 min-h-screen pb-20">
<!-- 顶部导航 -->
<header class="fixed top-0 left-0 right-0 z-50 glass-card mx-2 md:mx-4 mt-2 md:mt-4 rounded-xl md:rounded-2xl">
<div class="max-w-7xl mx-auto px-4 md:px-6 py-3 md:py-4 flex items-center justify-between">
<div class="flex items-center gap-2 md:gap-4">
<div class="taiji w-8 h-8 md:w-10 md:h-10"></div>
<h1 class="font-brush text-xl md:text-2xl text-gold">太虚仙门</h1>
</div>
<nav class="nav-desktop hidden md:flex items-center gap-6 lg:gap-8">
<a href="#" class="nav-item active text-paper/90 hover:text-gold transition-colors text-sm lg:text-base" data-section="home">首页</a>
<a href="#" class="nav-item text-paper/90 hover:text-gold transition-colors text-sm lg:text-base" data-section="realm">境界体系</a>
<a href="#" class="nav-item text-paper/90 hover:text-gold transition-colors text-sm lg:text-base" data-section="technique">功法秘籍</a>
<a href="#" class="nav-item text-paper/90 hover:text-gold transition-colors text-sm lg:text-base" data-section="alchemy">丹药宝典</a>
<a href="#" class="nav-item text-paper/90 hover:text-gold transition-colors text-sm lg:text-base" data-section="health">养生之道</a>
<a href="#" class="nav-item text-paper/90 hover:text-gold transition-colors text-sm lg:text-base" data-section="legend">神仙列传</a>
<a href="#" class="nav-item text-paper/90 hover:text-gold transition-colors text-sm lg:text-base" data-section="practice">修行</a>
<a href="#" class="nav-item text-paper/90 hover:text-gold transition-colors text-sm lg:text-base" data-section="trial">试炼场</a>
</nav>
<button id="mobileMenuBtn" class="nav-mobile md:hidden text-paper text-xl">
<i class="fas fa-bars"></i>
</button>
</div>
</header>

<!-- 移动端菜单 -->
<div id="mobileMenu" class="fixed inset-0 z-40 hidden">
<div class="absolute inset-0 bg-ink/95 backdrop-blur-xl"></div>
<div class="relative h-full flex flex-col items-center justify-center gap-6 overflow-y-auto py-20">
<a href="#" class="text-2xl font-brush text-paper hover:text-gold transition-colors" data-section="home">首页</a>
<a href="#" class="text-2xl font-brush text-paper hover:text-gold transition-colors" data-section="realm">境界体系</a>
<a href="#" class="text-2xl font-brush text-paper hover:text-gold transition-colors" data-section="technique">功法秘籍</a>
<a href="#" class="text-2xl font-brush text-paper hover:text-gold transition-colors" data-section="alchemy">丹药宝典</a>
<a href="#" class="text-2xl font-brush text-paper hover:text-gold transition-colors" data-section="health">养生之道</a>
<a href="#" class="text-2xl font-brush text-paper hover:text-gold transition-colors" data-section="legend">神仙列传</a>
<a href="#" class="text-2xl font-brush text-paper hover:text-gold transition-colors" data-section="practice">修行</a>
<a href="#" class="text-2xl font-brush text-paper hover:text-gold transition-colors" data-section="trial">试炼场</a>
<button id="closeMobileMenu" class="absolute top-8 right-8 text-paper text-2xl">
<i class="fas fa-times"></i>
</button>
</div>
</div>

<!-- 返回顶部按钮 -->
<button class="back-btn" onclick="scrollToTop()">
<i class="fas fa-chevron-up"></i>
</button>

<!-- 首页 -->
<section id="home" class="content-section active min-h-screen flex items-center pt-20 md:pt-24">
<div class="max-w-7xl mx-auto px-4 md:px-6 py-8 md:py-12">
<div class="grid lg:grid-cols-2 gap-8 md:gap-12 items-center">
<div class="space-y-6 md:space-y-8 animate-fade-in">
<div class="space-y-3 md:space-y-4">
<p class="text-jade text-base md:text-lg tracking-widest">问道长生 · 修真入门</p>
<h2 class="font-brush text-4xl md:text-5xl lg:text-7xl text-paper leading-tight">
天地有大美<br/>
<span class="text-gold">修真可长生</span>
</h2>
</div>
<div class="quote-block text-base md:text-lg">
<p class="mb-2">「抱朴子曰：」</p>
<p>夫求长生，修至道，诀在于志，不在于富贵名利。若夫存心于清虚之境，栖神于冥寂之域，则可以长生久视。</p>
</div>
<div class="flex flex-wrap gap-3 md:gap-4">
<button class="btn-immortal text-sm md:text-base" onclick="navigateTo('practice')">
<i class="fas fa-om mr-2"></i>开始修行
</button>
<button class="btn-immortal text-sm md:text-base" onclick="navigateTo('realm')">
<i class="fas fa-mountain mr-2"></i>了解境界
</button>
</div>
</div>
<div class="flex justify-center animate-fade-in animate-delay-2">
<div class="relative">
<div class="absolute inset-0 flex items-center justify-center">
<div class="w-48 md:w-64 h-48 md:h-64 rounded-full border border-gold/20 animate-pulse"></div>
</div>
<div class="absolute inset-0 flex items-center justify-center">
<div class="w-36 md:w-48 h-36 md:h-48 rounded-full border border-jade/30" style="animation: breathe 5s ease-in-out infinite;"></div>
</div>
<div class="relative z-10 flex flex-col items-center gap-4 md:gap-6">
<div class="taiji"></div>
<div class="golden-core"></div>
</div>
</div>
</div>
</div>

<!-- 核心理念 -->
<div class="mt-12 md:mt-24 grid md:grid-cols-3 gap-4 md:gap-6">
<div class="glass-card p-6 md:p-8 animate-fade-in animate-delay-1">
<div class="text-gold text-2xl md:text-3xl mb-3 md:mb-4"><i class="fas fa-yin-yang"></i></div>
<h3 class="font-brush text-xl md:text-2xl text-paper mb-2 md:mb-3">炼精化气</h3>
<p class="text-paper/70 text-sm md:text-base">炼后天之精，化为先天真气。此乃筑基之功，为修真第一步。精满则气足，气足则神旺。</p>
</div>
<div class="glass-card p-6 md:p-8 animate-fade-in animate-delay-2">
<div class="text-jade text-2xl md:text-3xl mb-3 md:mb-4"><i class="fas fa-circle-notch"></i></div>
<h3 class="font-brush text-xl md:text-2xl text-paper mb-2 md:mb-3">炼气化神</h3>
<p class="text-paper/70 text-sm md:text-base">以真气滋养元神，神气合一，金丹可成，寿元大增。神为气之主，气为神之母。</p>
</div>
<div class="glass-card p-6 md:p-8 animate-fade-in animate-delay-3">
<div class="text-spirit text-2xl md:text-3xl mb-3 md:mb-4"><i class="fas fa-sun"></i></div>
<h3 class="font-brush text-xl md:text-2xl text-paper mb-2 md:mb-3">炼神还虚</h3>
<p class="text-paper/70 text-sm md:text-base">神归于虚，与道合真。此乃修真之极境，超脱生死轮回，与天地同寿。</p>
</div>
</div>

<!-- 今日运势 -->
<div class="mt-12 md:mt-16 glass-card p-6 md:p-8">
<h3 class="font-brush text-xl md:text-2xl text-paper mb-4 md:mb-6 text-center">今日修真运势</h3>
<div class="grid md:grid-cols-4 gap-4 text-center">
<div class="p-4 rounded-xl bg-jade/10 border border-jade/20">
<div class="text-jade text-2xl mb-2"><i class="fas fa-sun"></i></div>
<div class="text-paper/70 text-sm mb-1">宜修炼</div>
<div class="text-jade font-brush text-lg">吐纳打坐</div>
</div>
<div class="p-4 rounded-xl bg-gold/10 border border-gold/20">
<div class="text-gold text-2xl mb-2"><i class="fas fa-mortar-pestle"></i></div>
<div class="text-paper/70 text-sm mb-1">宜炼丹</div>
<div class="text-gold font-brush text-lg">聚气丹</div>
</div>
<div class="p-4 rounded-xl bg-vermilion/10 border border-vermilion/20">
<div class="text-vermilion text-2xl mb-2"><i class="fas fa-bolt"></i></div>
<div class="text-paper/70 text-sm mb-1">忌</div>
<div class="text-vermilion font-brush text-lg">动武争斗</div>
</div>
<div class="p-4 rounded-xl bg-azure/10 border border-azure/20">
<div class="text-azure text-2xl mb-2"><i class="fas fa-star"></i></div>
<div class="text-paper/70 text-sm mb-1">机缘</div>
<div class="text-azure font-brush text-lg">遇贵人</div>
</div>
</div>
</div>
</div>
</section>

<!-- 境界体系 -->
<section id="realm" class="content-section min-h-screen pt-20 md:pt-24">
<div class="max-w-7xl mx-auto px-4 md:px-6 py-8 md:py-12">
<div class="text-center mb-12 md:mb-16">
<h2 class="font-brush text-3xl md:text-4xl lg:text-5xl text-paper mb-3 md:mb-4">修真境界体系</h2>
<p class="text-paper/60 max-w-2xl mx-auto text-sm md:text-base">修真一途，由凡入仙，历经重重境界。每一境界皆是生命层次的跃迁，与天地五行、人体脏腑息息相关。</p>
</div>

<!-- 五脏与境界 -->
<div class="glass-card p-6 md:p-8 mb-8 md:mb-12">
<h3 class="font-brush text-xl md:text-2xl text-paper mb-4 md:mb-6 text-center">五脏对应境界图</h3>
<div class="grid grid-cols-2 md:grid-cols-5 gap-4 md:gap-6">
<div class="text-center p-4 rounded-xl bg-jade/10 border border-jade/20 cursor-pointer hover:bg-jade/20 transition-all" onclick="showOrganDetail('lung')">
<div class="w-12 h-12 md:w-16 md:h-16 mx-auto rounded-full bg-jade/20 flex items-center justify-center mb-3">
<i class="fas fa-lungs text-jade text-xl md:text-2xl"></i>
</div>
<h4 class="text-jade font-brush text-lg md:text-xl mb-1">肺 · 金</h4>
<p class="text-paper/60 text-xs md:text-sm">炼气期</p>
<p class="text-paper/40 text-xs mt-1">主气之吸纳</p>
</div>
<div class="text-center p-4 rounded-xl bg-azure/10 border border-azure/20 cursor-pointer hover:bg-azure/20 transition-all" onclick="showOrganDetail('kidney')">
<div class="w-12 h-12 md:w-16 md:h-16 mx-auto rounded-full bg-azure/20 flex items-center justify-center mb-3">
<i class="fas fa-kidneys text-azure text-xl md:text-2xl"></i>
</div>
<h4 class="text-azure font-brush text-lg md:text-xl mb-1">肾 · 水</h4>
<p class="text-paper/60 text-xs md:text-sm">筑基期</p>
<p class="text-paper/40 text-xs mt-1">主精之收藏</p>
</div>
<div class="text-center p-4 rounded-xl bg-vermilion/10 border border-vermilion/20 cursor-pointer hover:bg-vermilion/20 transition-all" onclick="showOrganDetail('heart')">
<div class="w-12 h-12 md:w-16 md:h-16 mx-auto rounded-full bg-vermilion/20 flex items-center justify-center mb-3">
<i class="fas fa-heart text-vermilion text-xl md:text-2xl"></i>
</div>
<h4 class="text-vermilion font-brush text-lg md:text-xl mb-1">心 · 火</h4>
<p class="text-paper/60 text-xs md:text-sm">金丹期</p>
<p class="text-paper/40 text-xs mt-1">主神之凝聚</p>
</div>
<div class="text-center p-4 rounded-xl bg-spirit/10 border border-spirit/20 cursor-pointer hover:bg-spirit/20 transition-all" onclick="showOrganDetail('liver')">
<div class="w-12 h-12 md:w-16 md:h-16 mx-auto rounded-full bg-spirit/20 flex items-center justify-center mb-3">
<i class="fas fa-liver text-spirit text-xl md:text-2xl"></i>
</div>
<h4 class="text-spirit font-brush text-lg md:text-xl mb-1">肝 · 木</h4>
<p class="text-paper/60 text-xs md:text-sm">元婴期</p>
<p class="text-paper/40 text-xs mt-1">主魂之生长</p>
</div>
<div class="text-center p-4 rounded-xl bg-gold/10 border border-gold/20 cursor-pointer hover:bg-gold/20 transition-all" onclick="showOrganDetail('spleen')">
<div class="w-12 h-12 md:w-16 md:h-16 mx-auto rounded-full bg-gold/20 flex items-center justify-center mb-3">
<i class="fas fa-stomach text-gold text-xl md:text-2xl"></i>
</div>
<h4 class="text-gold font-brush text-lg md:text-xl mb-1">脾 · 土</h4>
<p class="text-paper/60 text-xs md:text-sm">化神期</p>
<p class="text-paper/40 text-xs mt-1">主意之统摄</p>
</div>
</div>
</div>

<!-- 境界展示 -->
<div class="grid gap-4 md:gap-6 mb-8 md:mb-12" id="realmList">
<!-- 境界卡片将由JS动态生成 -->
</div>
</div>
</section>

<!-- 功法秘籍 -->
<section id="technique" class="content-section min-h-screen pt-20 md:pt-24">
<div class="max-w-7xl mx-auto px-4 md:px-6 py-8 md:py-12">
<div class="text-center mb-12 md:mb-16">
<h2 class="font-brush text-3xl md:text-4xl lg:text-5xl text-paper mb-3 md:mb-4">功法秘籍</h2>
<p class="text-paper/60 max-w-2xl mx-auto text-sm md:text-base">修真之法，功法为基。择一而修，持之以恒，必有所成。万法归宗，道法自然。</p>
</div>

<!-- 功法分类标签 -->
<div class="flex flex-wrap justify-center gap-2 md:gap-4 mb-8 md:mb-12">
<button class="tab-btn active text-sm md:text-base" data-tab="basic" data-parent="technique">基础功法</button>
<button class="tab-btn text-sm md:text-base" data-tab="advanced" data-parent="technique">进阶功法</button>
<button class="tab-btn text-sm md:text-base" data-tab="secret" data-parent="technique">秘传心法</button>
<button class="tab-btn text-sm md:text-base" data-tab="special" data-parent="technique">特殊法门</button>
</div>

<div id="techniqueContent">
<!-- 功法内容将由JS动态生成 -->
</div>
</div>
</section>

<!-- 丹药宝典 -->
<section id="alchemy" class="content-section min-h-screen pt-20 md:pt-24">
<div class="max-w-7xl mx-auto px-4 md:px-6 py-8 md:py-12">
<div class="text-center mb-12 md:mb-16">
<h2 class="font-brush text-3xl md:text-4xl lg:text-5xl text-paper mb-3 md:mb-4">丹药宝典</h2>
<p class="text-paper/60 max-w-2xl mx-auto text-sm md:text-base">丹道者，外丹与内丹之统称。外丹以金石草木为药，内丹以精气神为药。灵丹妙药，可助修行。</p>
</div>

<!-- 丹药分类 -->
<div class="flex flex-wrap justify-center gap-2 md:gap-4 mb-8 md:mb-12">
<button class="tab-btn active text-sm md:text-base" data-tab="dans" data-parent="alchemy">灵丹妙药</button>
<button class="tab-btn text-sm md:text-base" data-tab="herbs" data-parent="alchemy">天材地宝</button>
<button class="tab-btn text-sm md:text-base" data-tab="formulas" data-parent="alchemy">丹方秘录</button>
</div>

<div id="alchemyContent">
<!-- 丹药内容将由JS动态生成 -->
</div>
</div>
</section>

<!-- 养生之道 -->
<section id="health" class="content-section min-h-screen pt-20 md:pt-24">
<div class="max-w-7xl mx-auto px-4 md:px-6 py-8 md:py-12">
<div class="text-center mb-12 md:mb-16">
<h2 class="font-brush text-3xl md:text-4xl lg:text-5xl text-paper mb-3 md:mb-4">养生之道</h2>
<p class="text-paper/60 max-w-2xl mx-auto text-sm md:text-base">凡人修行，先养其身。顺应天时，调和阴阳，方可延年益寿，为修真打下根基。</p>
</div>

<div id="healthContent">
<!-- 养生内容将由JS动态生成 -->
</div>
</div>
</section>

<!-- 神仙列传 -->
<section id="legend" class="content-section min-h-screen pt-20 md:pt-24">
<div class="max-w-7xl mx-auto px-4 md:px-6 py-8 md:py-12">
<div class="text-center mb-12 md:mb-16">
<h2 class="font-brush text-3xl md:text-4xl lg:text-5xl text-paper mb-3 md:mb-4">神仙列传</h2>
<p class="text-paper/60 max-w-2xl mx-auto text-sm md:text-base">古往今来，修真成仙者不知凡几。观其生平，悟其道心，可为后学之楷模。</p>
</div>

<div class="grid md:grid-cols-2 gap-6 md:gap-8" id="legendList">
<!-- 神仙列传将由JS动态生成 -->
</div>
</div>
</section>

<!-- 修行 -->
<section id="practice" class="content-section min-h-screen pt-20 md:pt-24">
<div class="max-w-7xl mx-auto px-4 md:px-6 py-8 md:py-12">
<div class="text-center mb-12 md:mb-16">
<h2 class="font-brush text-3xl md:text-4xl lg:text-5xl text-paper mb-3 md:mb-4">修行中心</h2>
<p class="text-paper/60 max-w-2xl mx-auto text-sm md:text-base">道在心中，修在行中。每日勤修，必有精进。持之以恒，终有所成。</p>
</div>

<div class="grid lg:grid-cols-3 gap-6 md:gap-8">
<!-- 修行状态 -->
<div class="lg:col-span-2 space-y-6 md:space-y-8">
<!-- 当前境界 -->
<div class="glass-card p-6 md:p-8">
<div class="flex items-center justify-between mb-4 md:mb-6">
<h3 class="font-brush text-xl md:text-2xl text-paper">当前境界</h3>
<button class="text-gold text-xs md:text-sm hover:text-gold/80 transition-colors" onclick="showRealmInfo()">
<i class="fas fa-info-circle mr-1"></i>详情
</button>
</div>
<div class="flex items-center gap-4 md:gap-6 mb-4 md:mb-6">
<div class="w-20 h-20 md:w-24 md:h-24 rounded-full bg-gradient-to-br from-jade/30 to-jade/10 flex items-center justify-center border-2 border-jade/30">
<span class="font-brush text-3xl md:text-4xl text-jade" id="currentRealmIcon">气</span>
</div>
<div class="flex-grow">
<div class="flex items-center gap-2 md:gap-3 mb-2">
<h4 class="font-brush text-xl md:text-2xl text-paper" id="currentRealmName">炼气期</h4>
<span class="text-jade text-xs md:text-sm px-3 py-1 rounded-full bg-jade/10" id="currentRealmStage">初期</span>
</div>
<p class="text-paper/60 text-sm md:text-base" id="currentRealmDesc">引天地灵气入体，开辟丹田</p>
</div>
</div>
<div class="space-y-2">
<div class="flex justify-between text-xs md:text-sm">
<span class="text-paper/70">修炼进度</span>
<span class="text-gold" id="practicePercent">35%</span>
</div>
<div class="realm-progress">
<div class="realm-progress-bar" id="practiceBar" style="width: 35%"></div>
</div>
</div>
<div class="grid grid-cols-3 gap-3 md:gap-4 mt-4 md:mt-6 text-center">
<div class="p-3 md:p-4 rounded-lg bg-ink/30">
<div class="text-paper/50 text-xs md:text-sm mb-1">灵力</div>
<div class="text-jade text-lg md:text-xl font-brush" id="spiritPower">1,250</div>
</div>
<div class="p-3 md:p-4 rounded-lg bg-ink/30">
<div class="text-paper/50 text-xs md:text-sm mb-1">修炼时辰</div>
<div class="text-gold text-lg md:text-xl font-brush" id="practiceHours">128</div>
</div>
<div class="p-3 md:p-4 rounded-lg bg-ink/30">
<div class="text-paper/50 text-xs md:text-sm mb-1">突破次数</div>
<div class="text-spirit text-lg md:text-xl font-brush" id="breakthroughCount">3</div>
</div>
</div>
</div>

<!-- 打坐冥想 -->
<div class="glass-card p-6 md:p-8">
<div class="flex items-center justify-between mb-4 md:mb-6">
<h3 class="font-brush text-xl md:text-2xl text-paper">打坐冥想</h3>
<div class="flex items-center gap-2">
<span class="text-paper/50 text-xs md:text-sm">状态：</span>
<span id="meditationStatus" class="text-jade text-xs md:text-sm">待机中</span>
</div>
</div>
<div class="text-center py-6 md:py-8">
<div class="relative inline-block mb-6 md:mb-8">
<div class="meditation-ring w-40 h-40 md:w-48 md:h-48"></div>
<div class="meditation-ring w-32 h-32 md:w-40 md:h-40 absolute top-4 left-4" style="animation-delay: 0.5s;"></div>
<div class="meditation-ring w-24 h-24 md:w-32 md:h-32 absolute top-8 left-8" style="animation-delay: 1s;"></div>
<div class="absolute inset-0 flex items-center justify-center">
<div class="meditation-timer text-3xl md:text-4xl" id="meditationTimer">00:00:00</div>
</div>
</div>
<div class="flex justify-center gap-3 md:gap-4">
<button id="startMeditation" class="btn-immortal text-sm md:text-base" onclick="startMeditation()">
<i class="fas fa-play mr-2"></i>开始冥想
</button>
<button id="stopMeditation" class="btn-immortal opacity-50 cursor-not-allowed text-sm md:text-base" disabled onclick="stopMeditation()">
<i class="fas fa-stop mr-2"></i>结束冥想
</button>
</div>
</div>
<div class="mt-4 md:mt-6 p-4 rounded-lg bg-ink/30">
<h4 class="text-gold text-xs md:text-sm mb-2">冥想要诀</h4>
<p class="text-paper/60 text-xs md:text-sm">盘膝而坐，双手结印，闭目调息。吸气时观想天地灵气从百会穴入体，呼气时观想浊气从涌泉穴排出。心无杂念，意守丹田。</p>
</div>
</div>
</div>

<!-- 侧边栏 -->
<div class="space-y-6 md:space-y-8">
<!-- 灵根测试 -->
<div class="glass-card p-4 md:p-6">
<h3 class="font-brush text-lg md:text-xl text-paper mb-3 md:mb-4">灵根测试</h3>
<p class="text-paper/60 text-xs md:text-sm mb-3 md:mb-4">测试你的修行资质，了解自己的灵根属性。</p>
<button class="btn-immortal w-full text-xs md:text-sm" onclick="startRootTest()">
<i class="fas fa-search mr-2"></i>开始测试
</button>
</div>

<!-- 每日任务 -->
<div class="glass-card p-4 md:p-6">
<h3 class="font-brush text-lg md:text-xl text-paper mb-3 md:mb-4">每日修行</h3>
<div class="space-y-2 md:space-y-3" id="dailyTasks">
<!-- 任务将由JS生成 -->
</div>
</div>

<!-- 修行记录 -->
<div class="glass-card p-4 md:p-6">
<h3 class="font-brush text-lg md:text-xl text-paper mb-3 md:mb-4">修行记录</h3>
<div class="space-y-2 md:space-y-3 max-h-48 overflow-y-auto" id="practiceLog">
<!-- 记录将由JS生成 -->
</div>
</div>
</div>
</div>
</div>
</section>

<!-- 试炼场 -->
<section id="trial" class="content-section min-h-screen pt-20 md:pt-24">
<div class="max-w-7xl mx-auto px-4 md:px-6 py-8 md:py-12">
<div class="text-center mb-12 md:mb-16">
<h2 class="font-brush text-3xl md:text-4xl lg:text-5xl text-paper mb-3 md:mb-4">试炼场</h2>
<p class="text-paper/60 max-w-2xl mx-auto text-sm md:text-base">修行之路，需不断磨砺。此处设有各种试炼，可测试你的神识反应、定力、记忆与悟性。</p>
</div>

<div class="grid md:grid-cols-2 gap-6 md:gap-8">
<!-- 神识反应测试 -->
<div class="glass-card p-6 md:p-8">
<h3 class="font-brush text-xl md:text-2xl text-paper mb-4 md:mb-6 text-center">神识反应</h3>
<p class="text-paper/60 text-center mb-6 text-sm md:text-base">测试你的神识反应速度，点击出现的灵光目标。</p>
<div id="reactionGame" class="relative bg-ink/50 rounded-xl h-64 md:h-80 overflow-hidden border border-jade/20">
<div class="absolute inset-0 flex items-center justify-center">
<p id="reactionStatus" class="text-paper/50 text-sm md:text-base">点击下方按钮开始测试</p>
</div>
<div id="reactionTarget" class="reaction-target"></div>
</div>
<div class="mt-4 md:mt-6 flex justify-center gap-3">
<button id="startReaction" class="btn-immortal text-sm md:text-base" onclick="startReactionGame()">
<i class="fas fa-play mr-2"></i>开始
</button>
<button id="stopReaction" class="btn-immortal opacity-50 cursor-not-allowed text-sm md:text-base" disabled onclick="stopReactionGame()">
<i class="fas fa-stop mr-2"></i>停止
</button>
</div>
<div class="mt-4 md:mt-6 grid grid-cols-3 gap-3 md:gap-4 text-center">
<div class="p-3 md:p-4 rounded-lg bg-ink/30">
<div class="text-paper/50 text-xs md:text-sm mb-1">反应次数</div>
<div class="text-jade text-lg md:text-xl font-brush" id="reactionCount">0</div>
</div>
<div class="p-3 md:p-4 rounded-lg bg-ink/30">
<div class="text-paper/50 text-xs md:text-sm mb-1">平均速度</div>
<div class="text-gold text-lg md:text-xl font-brush" id="avgReaction">--</div>
</div>
<div class="p-3 md:p-4 rounded-lg bg-ink/30">
<div class="text-paper/50 text-xs md:text-sm mb-1">评级</div>
<div class="text-spirit text-lg md:text-xl font-brush" id="reactionRank">未测试</div>
</div>
</div>
</div>

<!-- 定力测试 -->
<div class="glass-card p-6 md:p-8">
<h3 class="font-brush text-xl md:text-2xl text-paper mb-4 md:mb-6 text-center">定力试炼</h3>
<p class="text-paper/60 text-center mb-6 text-sm md:text-base">在干扰中保持专注，点击太极图标维持定力。</p>
<div id="focusGame" class="relative bg-ink/50 rounded-xl h-64 md:h-80 overflow-hidden border border-azure/20">
<div class="absolute inset-0 flex items-center justify-center">
<div id="focusTarget" class="w-16 h-16 md:w-20 md:h-20 rounded-full bg-azure/30 flex items-center justify-center transition-all duration-300 cursor-pointer">
<i class="fas fa-yin-yang text-azure text-2xl md:text-3xl animate-spin" style="animation-duration: 3s;"></i>
</div>
</div>
<div id="focusDistractions" class="absolute inset-0 pointer-events-none"></div>
</div>
<div class="mt-4 md:mt-6 flex justify-center gap-3">
<button id="startFocus" class="btn-immortal text-sm md:text-base" onclick="startFocusGame()">
<i class="fas fa-play mr-2"></i>开始
</button>
<button id="stopFocus" class="btn-immortal opacity-50 cursor-not-allowed text-sm md:text-base" disabled onclick="stopFocusGame()">
<i class="fas fa-stop mr-2"></i>停止
</button>
</div>
<div class="mt-4 md:mt-6 grid grid-cols-3 gap-3 md:gap-4 text-center">
<div class="p-3 md:p-4 rounded-lg bg-ink/30">
<div class="text-paper/50 text-xs md:text-sm mb-1">坚持时间</div>
<div class="text-azure text-lg md:text-xl font-brush" id="focusTime">0秒</div>
</div>
<div class="p-3 md:p-4 rounded-lg bg-ink/30">
<div class="text-paper/50 text-xs md:text-sm mb-1">最高记录</div>
<div class="text-gold text-lg md:text-xl font-brush" id="focusBest">0秒</div>
</div>
<div class="p-3 md:p-4 rounded-lg bg-ink/30">
<div class="text-paper/50 text-xs md:text-sm mb-1">评级</div>
<div class="text-spirit text-lg md:text-xl font-brush" id="focusRank">未测试</div>
</div>
</div>
</div>

<!-- 记忆阵法 -->
<div class="glass-card p-6 md:p-8">
<h3 class="font-brush text-xl md:text-2xl text-paper mb-4 md:mb-6 text-center">记忆阵法</h3>
<p class="text-paper/60 text-center mb-6 text-sm md:text-base">记住符文闪烁顺序，按正确顺序点击符文。</p>
<div id="memoryGame" class="grid grid-cols-4 gap-2 md:gap-3 max-w-md mx-auto">
<!-- 记忆卡片将由JS生成 -->
</div>
<div class="mt-4 md:mt-6 flex justify-center gap-3">
<button id="startMemory" class="btn-immortal text-sm md:text-base" onclick="startMemoryGame()">
<i class="fas fa-play mr-2"></i>开始
</button>
<button id="stopMemory" class="btn-immortal opacity-50 cursor-not-allowed text-sm md:text-base" disabled onclick="stopMemoryGame()">
<i class="fas fa-stop mr-2"></i>停止
</button>
</div>
<div class="mt-4 md:mt-6 grid grid-cols-3 gap-3 md:gap-4 text-center">
<div class="p-3 md:p-4 rounded-lg bg-ink/30">
<div class="text-paper/50 text-xs md:text-sm mb-1">当前关卡</div>
<div class="text-jade text-lg md:text-xl font-brush" id="memoryLevel">1</div>
</div>
<div class="p-3 md:p-4 rounded-lg bg-ink/30">
<div class="text-paper/50 text-xs md:text-sm mb-1">最高关卡</div>
<div class="text-gold text-lg md:text-xl font-brush" id="memoryBest">0</div>
</div>
<div class="p-3 md:p-4 rounded-lg bg-ink/30">
<div class="text-paper/50 text-xs md:text-sm mb-1">评级</div>
<div class="text-spirit text-lg md:text-xl font-brush" id="memoryRank">未测试</div>
</div>
</div>
</div>

<!-- 悟性测试 -->
<div class="glass-card p-6 md:p-8">
<h3 class="font-brush text-xl md:text-2xl text-paper mb-4 md:mb-6 text-center">悟性问答</h3>
<p class="text-paper/60 text-center mb-6 text-sm md:text-base">解答道家难题，测试你的悟性高低。</p>
<div id="wisdomGame" class="max-w-md mx-auto">
<div class="p-4 md:p-6 rounded-xl bg-ink/30 border border-gold/20 mb-4">
<p class="text-paper/80 text-base md:text-lg mb-4" id="wisdomQuestion">「道生一，一生二，二生三，三生万物。」此语何解？</p>
<div class="space-y-3" id="wisdomOptions">
<!-- 选项将由JS生成 -->
</div>
</div>
</div>
<div class="mt-4 md:mt-6 grid grid-cols-3 gap-3 md:gap-4 text-center">
<div class="p-3 md:p-4 rounded-lg bg-ink/30">
<div class="text-paper/50 text-xs md:text-sm mb-1">答题数</div>
<div class="text-jade text-lg md:text-xl font-brush" id="wisdomCount">0</div>
</div>
<div class="p-3 md:p-4 rounded-lg bg-ink/30">
<div class="text-paper/50 text-xs md:text-sm mb-1">正确率</div>
<div class="text-gold text-lg md:text-xl font-brush" id="wisdomCorrect">0%</div>
</div>
<div class="p-3 md:p-4 rounded-lg bg-ink/30">
<div class="text-paper/50 text-xs md:text-sm mb-1">评级</div>
<div class="text-spirit text-lg md:text-xl font-brush" id="wisdomRank">未测试</div>
</div>
</div>
</div>
</div>
</div>
</section>
</div>

<!-- 灵根测试弹窗 -->
<div id="rootTestModal" class="fixed inset-0 z-50 hidden">
<div class="absolute inset-0 bg-ink/95 backdrop-blur-xl"></div>
<div class="relative h-full flex items-center justify-center p-4">
<div class="glass-card p-6 md:p-8 max-w-md w-full max-h-[90vh] overflow-y-auto">
<div id="rootTestContent">
<!-- 内容由JS生成 -->
</div>
</div>
</div>
</div>

<!-- 功法学习弹窗 -->
<div id="learnTechniqueModal" class="fixed inset-0 z-50 hidden">
<div class="absolute inset-0 bg-ink/95 backdrop-blur-xl"></div>
<div class="relative h-full flex items-center justify-center p-4 overflow-y-auto">
<div class="glass-card p-6 md:p-8 max-w-2xl w-full my-8">
<div class="flex items-center justify-between mb-4 md:mb-6">
<h3 class="font-brush text-xl md:text-2xl text-paper" id="learnTechName">吐纳术</h3>
<button class="text-paper/50 hover:text-paper transition-colors" onclick="closeLearnTechnique()">
<i class="fas fa-times text-lg md:text-xl"></i>
</button>
</div>
<div id="learnTechContent">
<!-- 内容由JS生成 -->
</div>
</div>
</div>
</div>

<!-- 境界详情弹窗 -->
<div id="realmInfoModal" class="fixed inset-0 z-50 hidden">
<div class="absolute inset-0 bg-ink/95 backdrop-blur-xl"></div>
<div class="relative h-full flex items-center justify-center p-4 overflow-y-auto">
<div class="glass-card p-6 md:p-8 max-w-2xl w-full my-8">
<div class="flex items-center justify-between mb-4 md:mb-6">
<h3 class="font-brush text-xl md:text-2xl text-paper">境界详解</h3>
<button class="text-paper/50 hover:text-paper transition-colors" onclick="closeRealmInfo()">
<i class="fas fa-times text-lg md:text-xl"></i>
</button>
</div>
<div id="realmInfoContent">
<!-- 内容由JS生成 -->
</div>
</div>
</div>
</div>

<!-- 器官详情弹窗 -->
<div id="organInfoModal" class="fixed inset-0 z-50 hidden">
<div class="absolute inset-0 bg-ink/95 backdrop-blur-xl"></div>
<div class="relative h-full flex items-center justify-center p-4 overflow-y-auto">
<div class="glass-card p-6 md:p-8 max-w-lg w-full my-8">
<div class="flex items-center justify-between mb-4 md:mb-6">
<h3 class="font-brush text-xl md:text-2xl text-paper" id="organTitle">脏腑详解</h3>
<button class="text-paper/50 hover:text-paper transition-colors" onclick="closeOrganInfo()">
<i class="fas fa-times text-lg md:text-xl"></i>
</button>
</div>
<div id="organInfoContent">
<!-- 内容由JS生成 -->
</div>
</div>
</div>
</div>

<script>
// ==================== 数据定义 ====================

// 境界数据
const realmData = {
lianqi: {
name: '炼气期', icon: '气', stage: '初期', color: 'jade',
desc: '引天地灵气入体，开辟丹田，凝聚气旋',
lifespan: '百五十载',
stages: ['初期 (1-3层) - 气感初生', '中期 (4-6层) - 气旋初成', '后期 (7-9层) - 气海充盈'],
abilities: ['感应灵气', '引气入体', '开辟丹田', '轻身术'],
nextRealm: '筑基期',
requirement: '气旋化液，道基初成',
tribulation: '无天劫，但需度过心魔初劫',
changes: '经脉初通，感官敏锐，力大如牛，耳聪目明'
},
zhuji: {
name: '筑基期', icon: '基', stage: '初期', color: 'azure',
desc: '气旋化液，筑建道基',
lifespan: '三百载',
stages: ['初期 - 道基初成', '中期 - 道基稳固', '后期 - 道基圆满'],
abilities: ['御器飞行', '神识初显', '寿元大增', '辟谷不食'],
nextRealm: '金丹期',
requirement: '道基圆满，结丹有望',
tribulation: '小天劫，九道天雷',
changes: '肉身重塑，骨骼如玉，血液如汞，可御器飞行'
},
jindan: {
name: '金丹期', icon: '丹', stage: '初期', color: 'gold',
desc: '道基化丹，金丹大成',
lifespan: '五百载',
stages: ['初期 - 金丹初凝', '中期 - 金丹稳固', '后期 - 金丹圆满'],
abilities: ['御剑飞行', '神通初显', '辟谷不食', '寿元大增'],
nextRealm: '元婴期',
requirement: '金丹圆满，碎丹成婴',
tribulation: '中天劫，十八道天雷',
changes: '体内金丹永驻，神通自生，可瞬息千里'
},
yuanying: {
name: '元婴期', icon: '婴', stage: '初期', color: 'spirit',
desc: '碎丹成婴，元婴出窍',
lifespan: '千载',
stages: ['初期 - 元婴初生', '中期 - 元婴成长', '后期 - 元婴大成'],
abilities: ['元婴出窍', '瞬移千里', '分神化身', '夺舍重生'],
nextRealm: '化神期',
requirement: '元婴大成，化神有望',
tribulation: '大天劫，三十六道天雷',
changes: '元婴不灭，肉身可弃，神游太虚'
},
huashen: {
name: '化神期', icon: '神', stage: '初期', color: 'vermilion',
desc: '元婴化神，神念通达',
lifespan: '三千载',
stages: ['初期 - 神念初成', '中期 - 神念壮大', '后期 - 神念圆满'],
abilities: ['神念覆盖', '法则初悟', '移山填海', '创造空间'],
nextRealm: '返虚期',
requirement: '神念圆满，返虚有望',
tribulation: '九九重劫，八十一道天雷',
changes: '神念可覆盖万里，一念之间，天地变色'
},
fanxu: {
name: '返虚期', icon: '虚', stage: '初期', color: 'paper',
desc: '炼神还虚，与道合真',
lifespan: '万载',
stages: ['初期 - 虚空初入', '中期 - 虚空遨游', '后期 - 虚空大成'],
abilities: ['虚空遨游', '法则掌控', '不死不灭', '创造生灵'],
nextRealm: '合道期',
requirement: '虚空大成，合道有望',
tribulation: '心魔大劫，轮回之劫',
changes: '肉身可化为虚无，不受天地束缚'
},
hedao: {
name: '合道期', icon: '道', stage: '初期', color: 'gold',
desc: '身与道合，我即是道',
lifespan: '与天同寿',
stages: ['初期 - 道心初合', '中期 - 道法自然', '后期 - 道成真仙'],
abilities: ['言出法随', '创造世界', '超脱轮回', '与天同寿'],
nextRealm: '飞升仙界',
requirement: '道成真仙，飞升有望',
tribulation: '飞升之劫，天门大开',
changes: '身与道合，我即是道，超脱一切'
}
};

// 功法数据
const techniqueData = {
basic: [
{
name: '吐纳术', icon: 'fa-wind', color: 'jade', level: '入门必修',
desc: '采天地之灵气，纳日月之精华。此乃修真入门第一课，万法之基。',
difficulty: '入门', duration: '三月可成', prerequisite: '无',
mantra: '吸气观想天地灵气从百会穴入，沿任脉下行至丹田。呼气时，观想浊气从涌泉穴出。循环往复，日久功深。',
points: ['选择安静之处，盘膝而坐', '舌抵上颚，双手结印', '呼吸绵长，意守丹田', '每日修炼，不可间断'],
cycle: [
{ day: '第1-7日', content: '学习腹式呼吸，每日三次，每次半时辰。感受气息出入，调整呼吸节奏。', effect: '呼吸绵长，气感初生' },
{ day: '第8-21日', content: '观想灵气入体，沿任督二脉运行。配合打坐冥想，每日四次。', effect: '经脉初通，气机流畅' },
{ day: '第22-60日', content: '引气归元，凝聚气旋。此时可尝试开辟丹田，需心无旁骛。', effect: '丹田开辟，气旋初成' },
{ day: '第61-90日', content: '稳固境界，循环周天。气旋运转自如，吐纳术大成。', effect: '吐纳自如，根基稳固' }
]
},
{
name: '静心诀', icon: 'fa-brain', color: 'azure', level: '心法入门',
desc: '心者，君主之官。静心者，方能入定。此诀可祛除杂念，安定心神。',
difficulty: '简单', duration: '一月可成', prerequisite: '吐纳术',
mantra: '心如止水，意如明镜。杂念不起，神思清明。观心如观水，水静则明，心静则灵。',
points: ['闭目端坐，放松身心', '观想心如止水之境', '杂念起时，不追不随', '日久功深，心自安宁'],
cycle: [
{ day: '第1-7日', content: '学习放松身心，观想平静湖面。每日三次，每次一时辰。', effect: '身心放松，杂念减少' },
{ day: '第8-20日', content: '深入冥想，观心如镜。遇到杂念，轻轻放下，不追不随。', effect: '心神安定，入定渐深' },
{ day: '第21-30日', content: '稳固心境，心如止水。此时可长时间入定，心神清明。', effect: '静心有成，神思清明' }
]
},
{
name: '引气诀', icon: 'fa-water', color: 'spirit', level: '炼气基础',
desc: '引导灵气入体，开辟经脉。此为炼气期必修功法，筑基之根本。',
difficulty: '中等', duration: '半年可成', prerequisite: '静心诀',
mantra: '意引灵气，循经而行。十二正经，奇经八脉，一一打通。气行周天，无滞无碍。',
points: ['先通任督二脉', '再通十二正经', '后通奇经八脉', '周天循环，生生不息'],
cycle: [
{ day: '第1-30日', content: '引气通任督二脉，每日五次，每次两时辰。此为小周天。', effect: '任督二脉通，气行小周天' },
{ day: '第31-90日', content: '引气通十二正经，依次打通手三阴、手三阳、足三阴、足三阳。', effect: '十二正经通，气血畅行' },
{ day: '第91-150日', content: '引气通奇经八脉，冲、带、阴跷、阳跷、阴维、阳维。', effect: '奇经八脉通，大周天成' },
{ day: '第151-180日', content: '稳固经脉，气行无碍。全身经脉畅通，引气诀大成。', effect: '经脉全通，根基大成' }
]
},
{
name: '五行功', icon: 'fa-yin-yang', color: 'gold', level: '五行调和',
desc: '金木水火土，五行相生相克。修此功者，可调和五脏，强健体魄。',
difficulty: '中等', duration: '一年可成', prerequisite: '引气诀',
mantra: '金木水火土，五行相生相克。观想五行之气，调和阴阳，平衡身心。',
points: ['辨别自身五行属性', '选择相生方向修炼', '调和五行平衡', '强健体魄根基'],
cycle: [
{ day: '第1-60日', content: '辨别自身五行属性，观想对应五行之气入体。', effect: '五行属性明，气感增强' },
{ day: '第61-180日', content: '依次修炼五行之气，使五脏五行平衡。', effect: '五行调和，脏腑强健' },
{ day: '第181-365日', content: '五行循环，生生不息。五脏五行完美平衡。', effect: '五行大成，体魄强健' }
]
},
{
name: '炼体术', icon: 'fa-dumbbell', color: 'vermilion', level: '体修之法',
desc: '以灵气淬炼肉身，使体魄强健。体修一途，可肉身成圣，力大无穷。',
difficulty: '较难', duration: '三年初成', prerequisite: '五行功',
mantra: '以灵淬体，以体载道。皮肉筋骨，五脏六腑，一一淬炼，方成金刚。',
points: ['灵气淬炼皮肤', '淬炼筋骨肌肉', '淬炼五脏六腑', '最终肉身成圣'],
cycle: [
{ day: '第1-180日', content: '灵气淬炼皮肤，使皮肤坚韧如牛皮，刀剑难伤。', effect: '皮肤坚韧，防御增强' },
{ day: '第181-540日', content: '灵气淬炼筋骨肌肉，使筋骨如铁，肌肉如钢。', effect: '筋骨强健，力大无穷' },
{ day: '第541-1095日', content: '灵气淬炼五脏六腑，使内脏坚韧，百毒不侵。', effect: '内脏强健，肉身初成' }
]
},
{
name: '神识修炼法', icon: 'fa-eye', color: 'paper', level: '神念初开',
desc: '神识者，元神之触角。修此法者，可感知周遭，洞察秋毫。',
difficulty: '较难', duration: '两年可成', prerequisite: '静心诀',
mantra: '神识者，元神之触角。观想神识如水波扩散，感知周遭一切。',
points: ['静心凝神，意念外放', '观想神识如涟漪扩散', '逐步扩大感知范围', '神识强大，洞察秋毫'],
cycle: [
{ day: '第1-90日', content: '静心凝神，意念外放。感知身周三尺之物。', effect: '神识初生，感知三尺' },
{ day: '第91-365日', content: '观想神识扩散，逐步扩大至三丈、十丈。', effect: '神识扩大，感知十丈' },
{ day: '第366-730日', content: '神识继续扩大，可达百丈。此时可洞察秋毫。', effect: '神识大成，感知百丈' }
]
}
],
advanced: [
{
name: '筑基功', icon: 'fa-mountain', color: 'azure', level: '入道根基',
desc: '气旋化液，筑建道基。此功法为筑基期必修，决定日后成就。',
difficulty: '困难', duration: '十年可成', prerequisite: '炼气圆满',
mantra: '气旋化液，筑建道基。如建高楼，根基为先。道基稳固，日后可期。',
points: ['凝聚气旋', '气旋液化', '筑建道基', '道基稳固圆满'],
cycle: [
{ day: '第1-365日', content: '凝聚气旋，使气旋更加凝实。', effect: '气旋凝实，液化可期' },
{ day: '第366-1825日', content: '气旋液化，化为真元。此过程漫长，需耐心。', effect: '真元初生，液化有成' },
{ day: '第1826-3650日', content: '筑建道基，以真元筑基。道基稳固与否，决定日后成就。', effect: '道基初成，根基稳固' }
]
},
{
name: '结丹诀', icon: 'fa-circle', color: 'gold', level: '金丹大道',
desc: '道基化丹，金丹大成。此诀为金丹期核心功法，需大毅力。',
difficulty: '极难', duration: '三十年可成', prerequisite: '筑基圆满',
mantra: '道基化丹，金丹大成。阴阳相济，坎离交媾。十月温养，金丹可成。',
points: ['采药归壶', '封炉温养', '金丹初凝', '金丹大成'],
cycle: [
{ day: '第1-365日', content: '采药归壶，采先天一气入体。', effect: '先天一气，药归丹田' },
{ day: '第366-3650日', content: '封炉温养，如鸡抱卵，不可懈怠。', effect: '温养有成，金丹初凝' },
{ day: '第3651-10950日', content: '金丹大成，光耀如日。', effect: '金丹大成，寿元大增' }
]
},
{
name: '婴成诀', icon: 'fa-baby', color: 'spirit', level: '元婴之道',
desc: '碎丹成婴，元婴出窍。此诀修成，可神游太虚，瞬息千里。',
difficulty: '极难', duration: '百年可成', prerequisite: '金丹圆满',
mantra: '碎丹成婴，元婴出窍。如婴儿新生，需细心呵护。元婴成长，神通自显。',
points: ['金丹碎裂', '元婴初生', '细心温养', '元婴大成'],
cycle: [
{ day: '第1-3650日', content: '金丹碎裂，化为元婴雏形。', effect: '金丹碎，元婴生' },
{ day: '第3651-18250日', content: '元婴初生，细心温养。如婴儿般成长。', effect: '元婴成长，神通初显' },
{ day: '第18251-36500日', content: '元婴大成，可出窍神游。', effect: '元婴大成，神游太虚' }
]
}
],
secret: [
{
name: '抱朴子内篇', icon: 'fa-scroll', color: 'gold', level: '修真纲领',
desc: '东晋葛洪真人所著，修真之纲领，内丹学之经典。',
difficulty: '参悟', duration: '终身研读', prerequisite: '识字',
quotes: [
'夫求长生，修至道，诀在于志，不在于富贵名利。',
'人欲修真，当先修心。心者，一身之主，百神之帅。',
'凡学道术，当先知其本。本者，精气神也。'
],
books: [
{ name: '《道德经》', desc: '老子所著，道家根本经典' },
{ name: '《黄庭经》', desc: '内丹修炼要典' },
{ name: '《悟真篇》', desc: '张伯端著，金丹大道' },
{ name: '《性命圭旨》', desc: '性命双修之旨' },
{ name: '《周易参同契》', desc: '万古丹经王' },
{ name: '《太乙金华宗旨》', desc: '吕洞宾传，金丹要诀' }
]
}
],
special: [
{
name: '剑修法门', icon: 'fa-bolt', color: 'paper', level: '以剑入道',
desc: '以剑为媒，炼剑成意，御剑千里，剑气纵横。剑修一途，攻击最强。',
difficulty: '极难', duration: '终身修炼', prerequisite: '金丹期',
mantra: '以剑为媒，炼剑成意。剑意通神，御剑千里。人剑合一，剑气纵横。',
points: ['选一良剑', '日夜淬炼剑意', '人剑合一', '御剑飞行']
},
{
name: '符修法门', icon: 'fa-scroll', color: 'jade', level: '以符入道',
desc: '以灵画符，符成法随。可攻可守，可治可杀，变化多端。',
difficulty: '中等', duration: '终身修炼', prerequisite: '筑基期',
mantra: '以灵画符，符成法随。一笔一划，皆含道韵。符箓之道，变化无穷。',
points: ['学习符文', '以灵力画符', '符成法随', '变化无穷']
},
{
name: '阵修法门', icon: 'fa-th', color: 'azure', level: '以阵入道',
desc: '布阵困敌，聚灵养气。阵法之道，可御万敌，可聚天地灵气。',
difficulty: '困难', duration: '终身修炼', prerequisite: '筑基期',
mantra: '布阵困敌，聚灵养气。阵法之道，天地为盘，万物为子。',
points: ['学习阵法原理', '布设基础阵法', '聚灵困敌', '阵法大成']
}
]
};

// 丹药数据
const alchemyData = {
dans: [
{ name: '聚气丹', color: 'jade', level: '炼气期', desc: '炼气期修士必备，可加速灵气吸收，提升修炼速度三成。', grade: '下品', effect: '加速修炼', price: '100灵石' },
{ name: '筑基丹', color: 'azure', level: '筑基期', desc: '筑基必备灵丹，可增加筑基成功率两成，珍贵异常。', grade: '中品', effect: '助人筑基', price: '1000灵石' },
{ name: '金丹丹', color: 'gold', level: '金丹期', desc: '结丹期辅助灵丹，可稳固金丹，防止金丹碎裂。', grade: '上品', effect: '稳固金丹', price: '10000灵石' },
{ name: '元婴丹', color: 'spirit', level: '元婴期', desc: '碎丹成婴之辅助灵丹，可护持元婴初生，防止夭折。', grade: '极品', effect: '护持元婴', price: '10万灵石' },
{ name: '回气丹', color: 'jade', level: '通用', desc: '快速恢复灵气，战斗必备。炼气期即可使用。', grade: '下品', effect: '恢复灵气', price: '50灵石' },
{ name: '疗伤丹', color: 'vermilion', level: '通用', desc: '治愈内外伤势，加速恢复。炼气期即可使用。', grade: '下品', effect: '治愈伤势', price: '80灵石' },
{ name: '辟谷丹', color: 'gold', level: '辅助', desc: '服后可七日不食，辟谷修行。减少凡尘俗事干扰。', grade: '下品', effect: '辟谷不食', price: '30灵石' },
{ name: '清心丹', color: 'azure', level: '辅助', desc: '祛除心魔，安定心神。突破瓶颈时必备。', grade: '中品', effect: '祛除心魔', price: '500灵石' },
{ name: '延寿丹', color: 'paper', level: '珍贵', desc: '可延寿五十年，凡人亦可服用。极其珍贵。', grade: '极品', effect: '延寿五十年', price: '百万灵石' }
],
herbs: [
{ name: '千年人参', color: 'spirit', type: '灵植', desc: '生长千年之人参，蕴含庞大生命精华。可炼制筑基丹。', age: '千年以上', use: '炼丹、服用' },
{ name: '灵石', color: 'gold', type: '货币', desc: '蕴含灵气之矿石，修真界通用货币。可用于修炼、交易。', grade: '下中上极品', use: '交易、修炼' },
{ name: '朱果', color: 'vermilion', type: '灵果', desc: '生长于灵气充沛之地，服之可增加十年修为。', age: '三百年成熟', use: '直接服用' },
{ name: '玄铁', color: 'paper', type: '灵材', desc: '坚硬无比，炼制法宝之上佳材料。可炼制飞剑。', grade: '中品灵材', use: '炼器' },
{ name: '龙血草', color: 'vermilion', type: '灵草', desc: '沐浴龙血而生，蕴含龙族血脉之力。体修至宝。', rarity: '极稀有', use: '炼丹、体修' },
{ name: '凤羽花', color: 'gold', type: '灵花', desc: '形似凤羽，蕴含凤凰真火。火修至宝。', rarity: '极稀有', use: '炼丹、火修' }
],
formulas: [
{ name: '聚气丹方', color: 'jade', materials: ['灵草 x3', '聚灵花 x1', '清泉水 x2'], method: '以文火炼制三个时辰，待药液成金黄色即可出丹。' },
{ name: '筑基丹方', color: 'azure', materials: ['天灵果 x1', '筑基草 x5', '千年人参 x1', '无根水 x3'], method: '以武火炼制七日七夜，需时刻关注火候，待丹药成型后以文火温养三日。' },
{ name: '金丹丹方', color: 'gold', materials: ['金精 x3', '九转灵草 x1', '龙血草 x2', '天雷液 x1'], method: '需在雷雨天气炼制，引天雷入炉，炼制四十九日。极难炼制，失败率极高。' }
]
};

// 养生数据
const healthData = [
{
title: '子时养阴 · 睡眠之道',
icon: 'fa-moon',
color: 'azure',
desc: '子时（23:00-1:00）为阴气最盛之时，此时入睡，可滋养肾阴，收藏精气。',
xuanxue: '子时一阳生，阴极阳生。此时入睡，可使阴阳交泰，精气自生。若熬夜不睡，则耗损阴精，折损寿元。',
science: '夜间23点至凌晨1点是人体器官修复的关键时期，此时入睡有助于肝脏排毒、免疫系统修复，促进生长激素分泌。',
tips: ['睡前热水泡脚，引火归元', '不宜过饱或过饥入睡', '保持卧室安静黑暗', '睡前避免剧烈运动']
},
{
title: '卯时采气 · 晨起修炼',
icon: 'fa-sun',
color: 'jade',
desc: '卯时（5:00-7:00）为阳气初升之时，此时起床修炼，可采天地初生之阳气。',
xuanxue: '卯时阳气始生，天地灵气最为纯净。此时吐纳修炼，可吸纳先天一气，洗涤体内浊气。',
science: '清晨空气新鲜，含氧量高，负离子丰富。此时锻炼可提高心肺功能，促进新陈代谢，增强免疫力。',
tips: ['起床后先饮温水一杯', '晨练不宜过于剧烈', '配合吐纳之术效果更佳', '晨练后进食早餐']
},
{
title: '饮食调和 · 五行膳食',
icon: 'fa-utensils',
color: 'gold',
desc: '饮食者，民之本也。五味入五脏，五色补五行。合理饮食，可调和阴阳。',
elements: [
{ name: '酸入肝', color: 'jade', element: '木' },
{ name: '苦入心', color: 'vermilion', element: '火' },
{ name: '甘入脾', color: 'gold', element: '土' },
{ name: '辛入肺', color: 'paper', element: '金' },
{ name: '咸入肾', color: 'azure', element: '水' }
],
tips: ['早餐宜温热，补阳气', '午餐宜丰富，养脾胃', '晚餐宜清淡，养阴气', '不暴饮暴食']
},
{
title: '运动炼体 · 淬炼肉身',
icon: 'fa-running',
color: 'vermilion',
desc: '动则生阳，静则生阴。适度运动，可激发阳气，强健筋骨。',
xuanxue: '运动之时，体内阳气升发，可驱除寒湿邪气。筋骨强健，则经脉通畅，灵气运行无碍。',
science: '规律运动可增强心肺功能，提高基础代谢率，促进血液循环，增强肌肉力量和骨密度。',
tips: ['运动量循序渐进', '运动后不宜立即洗澡', '配合呼吸吐纳', '持之以恒方见功效']
}
];

// 神仙列传数据
const legendData = [
{
name: '彭祖', icon: '彭', color: 'gold', title: '寿八百载 · 养生之祖',
desc: '彭祖，姓篓名铿，传说活了八百岁。善养生之术，创导引行气之法。',
quote: '道不在烦，但能不思衣食，不思声色，不思胜负，不思曲直，不思得失，不思荣辱。心无烦，形无极，兼以导引，此可长生。',
story: '彭祖自尧帝时起，历经夏商周三代，活了八百岁。其养生之术，重在调心、调息、调身三者合一。每日导引行气，饮食有节，起居有常，故能长寿。'
},
{
name: '张三丰', icon: '丰', color: 'spirit', title: '武当祖师 · 太极宗师',
desc: '张三丰，武当派创始人，太极拳祖师。传说活了二百余岁，后不知所踪。',
quote: '太极者，无极而生，动静之机，阴阳之母也。动之则分，静之则合。无过不及，随曲就伸。',
story: '张三丰于武当山修道，观蛇鹊相斗而悟太极之理。创太极拳法，以柔克刚，后发制人。其人神龙见首不见尾，传说最终羽化登仙。'
},
{
name: '吕洞宾', icon: '吕', color: 'jade', title: '八仙之一 · 纯阳祖师',
desc: '吕洞宾，号纯阳子，八仙之一。传钟离权授以金丹之道，后成仙得道。',
quote: '一粒金丹吞入腹，始知我命不由天。',
story: '吕洞宾本为书生，两举进士不第。后遇钟离权，授以黄粱一梦，悟道出家。经十试而不退，终得金丹大道，飞升成仙。'
},
{
name: '老子', icon: '老', color: 'azure', title: '道家始祖 · 道德天尊',
desc: '老子，姓李名耳，字聃。著《道德经》五千言，为道家根本经典。',
quote: '道可道，非常道；名可名，非常名。无名天地之始，有名万物之母。',
story: '老子为周朝守藏室之史，见周之衰，乃西出函谷关。关令尹喜请著书，乃著《道德经》五千言而去，莫知其所终。'
},
{
name: '葛洪', icon: '葛', color: 'vermilion', title: '抱朴子 · 丹道大师',
desc: '葛洪，字稚川，自号抱朴子。东晋道教学者，著《抱朴子》内外篇。',
quote: '夫求长生，修至道，诀在于志，不在于富贵名利。',
story: '葛洪少好学，家贫无书，手不释卷。后师从郑隐学炼丹之术，著《抱朴子》阐述神仙理论。晚年隐居罗浮山，炼丹修道。'
},
{
name: '陈抟', icon: '陈', color: 'paper', title: '睡仙 · 希夷先生',
desc: '陈抟，字图南，号希夷先生。以睡功闻名，传说一睡数月不起。',
quote: '至人之睡，先睡心，后睡眼。凡人之睡，先睡眼，后睡心。',
story: '陈抟隐居华山，以睡功闻名。传说一睡百余日不起，其实是以睡入定，修炼内丹。创先天易学，对后世影响深远。'
}
];

// 五脏数据
const organData = {
lung: {
name: '肺', element: '金', color: 'jade', realm: '炼气期',
desc: '肺主气，司呼吸，为气机之枢纽。肺金之气，主收敛、清洁、肃降。',
functions: ['主气，司呼吸', '主宣发肃降', '主通调水道', '朝百脉，主治节'],
health: '肺气充足，则呼吸顺畅，声音洪亮，皮肤光泽。肺气虚弱，则气短喘促，声音低微，皮肤干燥。',
practice: '修炼吐纳之术，可增强肺金之气。每日清晨，面向东方，深呼吸四十九次，可增强肺功能。'
},
kidney: {
name: '肾', element: '水', color: 'azure', realm: '筑基期',
desc: '肾主水，藏精，为先天之本。肾水之气，主收藏、滋润、潜藏。',
functions: ['藏精，主生殖', '主水液代谢', '主纳气', '主骨生髓'],
health: '肾气充足，则精力充沛，耳聪目明，发黑齿固。肾气虚弱，则精神疲惫，耳鸣耳聋，发白齿摇。',
practice: '节制房事，可保肾精不泄。每日按摩后腰肾俞穴，可增强肾气。'
},
heart: {
name: '心', element: '火', color: 'vermilion', realm: '金丹期',
desc: '心主火，藏神，为君主之官。心火之气，主温煦、推动、光明。',
functions: ['主血脉', '藏神', '主汗液', '开窍于舌'],
health: '心气充足，则面色红润，神志清醒，思维敏捷。心气虚弱，则面色苍白，神志恍惚，健忘失眠。',
practice: '静心养神，可增强心火之气。每日午时，静坐冥想，意守心窍，可养心安神。'
},
liver: {
name: '肝', element: '木', color: 'spirit', realm: '元婴期',
desc: '肝主木，藏魂，主疏泄。肝木之气，主生发、条达、舒畅。',
functions: ['主疏泄', '藏血', '主筋', '开窍于目'],
health: '肝气充足，则情绪舒畅，目光明亮，筋骨强健。肝气郁结，则情绪抑郁，目涩视昏，筋脉拘急。',
practice: '保持情绪舒畅，可养肝木之气。每日丑时（1-3点）熟睡，可养肝血。'
},
spleen: {
name: '脾', element: '土', color: 'gold', realm: '化神期',
desc: '脾主土，藏意，主运化。脾土之气，主运化、升清、统血。',
functions: ['主运化', '主升清', '主统血', '主肌肉四肢'],
health: '脾气充足，则食欲旺盛，肌肉丰满，四肢有力。脾气虚弱，则食欲不振，肌肉消瘦，四肢无力。',
practice: '饮食有节，可养脾土之气。每日辰时（7-9点）进食早餐，可健脾养胃。'
}
};

// 悟性问答数据
const wisdomQuestions = [
{
question: '「道生一，一生二，二生三，三生万物。」此语何解？',
options: ['道生万物，万物归道', '道是数字，数学为本', '道生一气，一气化阴阳，阴阳生万物'],
correct: 3
},
{
question: '「上善若水，水善利万物而不争。」此语何意？',
options: ['水最善良，不与人争', '至高之善如水，滋养万物而不争名利', '要像水一样软弱'],
correct: 2
},
{
question: '「致虚极，守静笃。」此乃何意？',
options: ['要空虚到极点，安静地等待', '达到虚空的极致，坚守清静的境界', '放弃一切，什么都不做'],
correct: 2
},
{
question: '「金丹大道，以神运气。」何为金丹？',
options: ['黄金做的丹药', '内丹修炼所结之丹', '仙丹妙药'],
correct: 2
},
{
question: '「炼精化气，炼气化神，炼神还虚。」此为何功？',
options: ['外丹术', '内丹术', '符箓术'],
correct: 2
},
{
question: '「道法自然。」何为自然？',
options: ['大自然，山川河流', '自然而然，本来如此', '随意而为，不加约束'],
correct: 2
},
{
question: '「无为而无不为。」何解？',
options: ['什么都不做，就能成就一切', '顺应自然而为，不妄为，故能成就一切', '消极等待，听天由命'],
correct: 2
},
{
question: '「人法地，地法天，天法道，道法自然。」何意？',
options: ['人要效法天地自然之道', '人要服从天地，天地服从道', '人、地、天、道依次效法，最终归于自然'],
correct: 3
}
];

// ==================== 状态变量 ====================
let currentSection = 'home';
let isMeditating = false;
let meditationTimer = null;
let meditationSeconds = 0;

// 反应测试状态
let reactionGameState = 'idle';
let reactionStartTime = 0;
let reactionTimes = [];
let reactionTimeout = null;

// 定力测试状态
let focusGameState = 'idle';
let focusStartTime = 0;
let focusTimer = null;
let focusDistractionInterval = null;
let focusBestTime = 0;
let focusScaleInterval = null;

// 记忆游戏状态
let memoryGameState = 'idle';
let memorySequence = [];
let memoryPlayerSequence = [];
let memoryLevel = 1;
let memoryBestLevel = 0;
let memoryFlashInterval = null;

// 悟性测试状态
let wisdomCurrentQuestion = 0;
let wisdomCorrectCount = 0;
let wisdomTotalCount = 0;

// ==================== 初始化 ====================
document.addEventListener('DOMContentLoaded', function() {
createParticles();
createRunes();
initNavigation();
initMobileMenu();
initTabs();
generateRealmList();
generateTechniqueContent();
generateAlchemyContent();
generateHealthContent();
generateLegendList();
generateDailyTasks();
generatePracticeLog();
generateMemoryCards();
loadWisdomQuestion();
});

// 创建灵气粒子
function createParticles() {
const container = document.getElementById('particles');
for (let i = 0; i < 30; i++) {
const particle = document.createElement('div');
particle.className = 'qi-particle';
particle.style.left = Math.random() * 100 + '%';
particle.style.bottom = '-20px';
particle.style.animationDelay = Math.random() * 8 + 's';
particle.style.animationDuration = (6 + Math.random() * 4) + 's';
container.appendChild(particle);
}
}

// 创建漂浮符文
function createRunes() {
const container = document.getElementById('runes');
const runes = ['道', '气', '神', '精', '虚', '阴', '阳', '金', '木', '水', '火', '土'];
for (let i = 0; i < 15; i++) {
const rune = document.createElement('div');
rune.className = 'rune';
rune.textContent = runes[Math.floor(Math.random() * runes.length)];
rune.style.left = Math.random() * 100 + '%';
rune.style.top = Math.random() * 100 + '%';
rune.style.animationDelay = Math.random() * 10 + 's';
rune.style.fontSize = (1.5 + Math.random() * 2) + 'rem';
container.appendChild(rune);
}
}

// 导航初始化
function initNavigation() {
const navItems = document.querySelectorAll('.nav-item');
navItems.forEach(item => {
item.addEventListener('click', function(e) {
e.preventDefault();
const section = this.dataset.section;
navigateTo(section);
});
});
}

// 页面导航
function navigateTo(section) {
document.querySelectorAll('.nav-item').forEach(item => {
item.classList.remove('active');
if (item.dataset.section === section) {
item.classList.add('active');
}
});

document.querySelectorAll('.content-section').forEach(sec => {
sec.classList.remove('active');
});
document.getElementById(section).classList.add('active');

document.getElementById('mobileMenu').classList.add('hidden');

currentSection = section;
window.scrollTo({ top: 0, behavior: 'smooth' });
}

// 滚动到顶部
function scrollToTop() {
window.scrollTo({ top: 0, behavior: 'smooth' });
}

// 移动端菜单
function initMobileMenu() {
const menuBtn = document.getElementById('mobileMenuBtn');
const closeBtn = document.getElementById('closeMobileMenu');
const mobileMenu = document.getElementById('mobileMenu');
const menuLinks = mobileMenu.querySelectorAll('a');

menuBtn.addEventListener('click', () => {
mobileMenu.classList.remove('hidden');
});

closeBtn.addEventListener('click', () => {
mobileMenu.classList.add('hidden');
});

menuLinks.forEach(link => {
link.addEventListener('click', function(e) {
e.preventDefault();
const section = this.dataset.section;
navigateTo(section);
});
});
}

// 标签切换初始化
function initTabs() {
document.querySelectorAll('.tab-btn').forEach(btn => {
btn.addEventListener('click', function() {
const tabId = this.dataset.tab;
const parentId = this.dataset.parent || this.closest('section').id;

// 更新标签状态
this.closest('.flex').querySelectorAll('.tab-btn').forEach(t => t.classList.remove('active'));
this.classList.add('active');

// 更新内容
const contentContainer = document.querySelector(`#${parentId} .tab-content`)?.parentElement;
if (contentContainer) {
contentContainer.querySelectorAll('.tab-content').forEach(content => {
content.classList.add('hidden');
content.classList.remove('active');
});
const targetContent = contentContainer.querySelector(`.tab-content[data-content="${tabId}"]`);
if (targetContent) {
targetContent.classList.remove('hidden');
targetContent.classList.add('active');
}
}
});
});
}

// ==================== 内容生成函数 ====================

// 生成境界列表
function generateRealmList() {
const container = document.getElementById('realmList');
let html = '';

for (const [key, data] of Object.entries(realmData)) {
html += `
<div class="glass-card p-4 md:p-6 lg:p-8 realm-card cursor-pointer" data-realm="${key}">
<div class="flex flex-col lg:flex-row lg:items-center gap-4 md:gap-6">
<div class="flex-shrink-0 flex justify-center lg:justify-start">
<div class="w-16 h-16 md:w-20 md:h-20 rounded-full bg-gradient-to-br from-${data.color}/30 to-${data.color}/10 flex items-center justify-center border border-${data.color}/30">
<span class="font-brush text-2xl md:text-3xl text-${data.color}">${data.icon}</span>
</div>
</div>
<div class="flex-grow">
<div class="flex flex-wrap items-center gap-2 md:gap-4 mb-2">
<h3 class="font-brush text-xl md:text-2xl text-paper">${data.name}</h3>
<span class="text-${data.color} text-xs md:text-sm px-3 py-1 rounded-full bg-${data.color}/10">${data.stage}</span>
</div>
<p class="text-paper/70 mb-3 md:mb-4 text-sm md:text-base">${data.desc}</p>
<div class="grid grid-cols-3 gap-2 md:gap-4 text-center text-xs md:text-sm">
${data.stages.slice(0, 3).map((s, i) => `
<div class="p-2 md:p-3 rounded-lg bg-ink/30">
<div class="text-${data.color} mb-1">${['初', '中', '后'][i]}期</div>
<div class="text-paper/50">${s.split(' - ')[1] || s}</div>
</div>
`).join('')}
</div>
</div>
<div class="flex-shrink-0 text-center lg:text-right">
<div class="text-paper/50 text-xs md:text-sm">寿元</div>
<div class="text-gold text-lg md:text-xl font-brush">${data.lifespan}</div>
</div>
</div>
</div>
`;
}

container.innerHTML = html;

// 添加点击事件
container.querySelectorAll('.realm-card').forEach(card => {
card.addEventListener('click', function() {
const realm = this.dataset.realm;
showRealmDetail(realm);
});
});
}

// 显示境界详情
function showRealmDetail(realmKey) {
const data = realmData[realmKey];
if (!data) return;

const content = `
<div class="space-y-4 md:space-y-6">
<div class="flex items-center gap-4 md:gap-6">
<div class="w-16 h-16 md:w-20 md:h-20 rounded-full bg-${data.color}/20 flex items-center justify-center border-2 border-${data.color}/30">
<span class="font-brush text-3xl md:text-4xl text-${data.color}">${data.icon}</span>
</div>
<div>
<h4 class="font-brush text-xl md:text-2xl text-paper">${data.name}</h4>
<p class="text-${data.color} text-sm md:text-base">${data.stage}</p>
</div>
</div>

<p class="text-paper/70 text-sm md:text-base">${data.desc}</p>

<div class="grid md:grid-cols-2 gap-3 md:gap-4">
<div class="p-3 md:p-4 rounded-lg bg-ink/30">
<div class="text-paper/50 text-xs md:text-sm mb-1">寿元</div>
<div class="text-gold text-base md:text-lg">${data.lifespan}</div>
</div>
<div class="p-3 md:p-4 rounded-lg bg-ink/30">
<div class="text-paper/50 text-xs md:text-sm mb-1">下一境界</div>
<div class="text-paper text-base md:text-lg">${data.nextRealm}</div>
</div>
</div>

<div>
<h4 class="text-gold text-base md:text-lg mb-2 md:mb-3">境界阶段</h4>
<div class="space-y-2">
${data.stages.map(s => `<div class="p-2 md:p-3 rounded-lg bg-ink/30 text-paper/80 text-sm md:text-base">${s}</div>`).join('')}
</div>
</div>

<div>
<h4 class="text-gold text-base md:text-lg mb-2 md:mb-3">能力解锁</h4>
<div class="flex flex-wrap gap-2">
${data.abilities.map(a => `<span class="px-3 py-1 rounded-full bg-${data.color}/20 text-${data.color} text-xs md:text-sm">${a}</span>`).join('')}
</div>
</div>

<div class="p-3 md:p-4 rounded-lg bg-ink/30 border border-gold/20">
<h4 class="text-gold text-xs md:text-sm mb-2">突破要求</h4>
<p class="text-paper/70 text-xs md:text-sm">${data.requirement}</p>
</div>

<div class="p-3 md:p-4 rounded-lg bg-ink/30 border border-vermilion/20">
<h4 class="text-vermilion text-xs md:text-sm mb-2">天劫考验</h4>
<p class="text-paper/70 text-xs md:text-sm">${data.tribulation}</p>
</div>

<div class="p-3 md:p-4 rounded-lg bg-ink/30 border border-jade/20">
<h4 class="text-jade text-xs md:text-sm mb-2">肉身变化</h4>
<p class="text-paper/70 text-xs md:text-sm">${data.changes}</p>
</div>
</div>
`;

document.getElementById('realmInfoContent').innerHTML = content;
document.getElementById('realmInfoModal').classList.remove('hidden');
}

function closeRealmInfo() {
document.getElementById('realmInfoModal').classList.add('hidden');
}

// 显示器官详情
function showOrganDetail(organKey) {
const data = organData[organKey];
if (!data) return;

const content = `
<div class="space-y-4">
<div class="flex items-center gap-4">
<div class="w-16 h-16 rounded-full bg-${data.color}/20 flex items-center justify-center">
<i class="fas fa-${organKey === 'lung' ? 'lungs' : organKey === 'kidney' ? 'kidneys' : organKey === 'heart' ? 'heart' : organKey === 'liver' ? 'liver' : 'stomach'} text-${data.color} text-2xl"></i>
</div>
<div>
<h4 class="font-brush text-xl text-${data.color}">${data.name} · ${data.element}</h4>
<p class="text-paper/60 text-sm">对应境界：${data.realm}</p>
</div>
</div>

<p class="text-paper/70">${data.desc}</p>

<div>
<h4 class="text-gold text-sm mb-2">主要功能</h4>
<ul class="space-y-1">
${data.functions.map(f => `<li class="text-paper/70 text-sm">• ${f}</li>`).join('')}
</ul>
</div>

<div class="p-3 rounded-lg bg-ink/30">
<h4 class="text-jade text-sm mb-2">健康状态</h4>
<p class="text-paper/70 text-sm">${data.health}</p>
</div>

<div class="p-3 rounded-lg bg-ink/30">
<h4 class="text-azure text-sm mb-2">修炼之法</h4>
<p class="text-paper/70 text-sm">${data.practice}</p>
</div>
</div>
`;

document.getElementById('organTitle').textContent = `${data.name} · ${data.element}行`;
document.getElementById('organInfoContent').innerHTML = content;
document.getElementById('organInfoModal').classList.remove('hidden');
}

function closeOrganInfo() {
document.getElementById('organInfoModal').classList.add('hidden');
}

// 生成功法内容
function generateTechniqueContent() {
const container = document.getElementById('techniqueContent');
let html = '';

// 基础功法
html += `<div class="tab-content active" data-content="basic">
<div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6">
${techniqueData.basic.map(tech => generateTechCard(tech)).join('')}
</div>
</div>`;

// 进阶功法
html += `<div class="tab-content hidden" data-content="advanced">
<div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6">
${techniqueData.advanced.map(tech => generateTechCard(tech)).join('')}
</div>
</div>`;

// 秘传心法
html += `<div class="tab-content hidden" data-content="secret">
<div class="glass-card p-6 md:p-8 max-w-3xl mx-auto">
${generateSecretContent()}
</div>
</div>`;

// 特殊法门
html += `<div class="tab-content hidden" data-content="special">
<div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6">
${techniqueData.special.map(tech => generateTechCard(tech)).join('')}
</div>
</div>`;

container.innerHTML = html;
}

function generateTechCard(tech) {
return `
<div class="scroll-card">
<div class="flex items-center gap-3 mb-3 md:mb-4">
<div class="w-10 h-10 md:w-12 md:h-12 rounded-lg bg-${tech.color}/20 flex items-center justify-center">
<i class="fas ${tech.icon} text-${tech.color} text-lg md:text-xl"></i>
</div>
<div>
<h4 class="font-brush text-lg md:text-xl text-paper">${tech.name}</h4>
<span class="text-${tech.color} text-xs md:text-sm">${tech.level}</span>
</div>
</div>
<p class="text-paper/70 mb-3 md:mb-4 text-sm md:text-base">${tech.desc}</p>
<div class="space-y-2 text-xs md:text-sm text-paper/60">
<div class="flex justify-between">
<span>修炼难度</span>
<span class="text-${tech.color}">${tech.difficulty}</span>
</div>
<div class="flex justify-between">
<span>修炼时长</span>
<span>${tech.duration}</span>
</div>
<div class="flex justify-between">
<span>前置要求</span>
<span>${tech.prerequisite}</span>
</div>
</div>
<button class="btn-immortal w-full mt-3 md:mt-4 text-xs md:text-sm" onclick="learnTechnique('${tech.name}')">
<i class="fas fa-book-open mr-2"></i>开始修习
</button>
</div>
`;
}

function generateSecretContent() {
const secret = techniqueData.secret[0];
return `
<div class="text-center mb-6 md:mb-8">
<div class="w-16 h-16 md:w-20 md:h-20 mx-auto rounded-full bg-${secret.color}/20 flex items-center justify-center mb-4">
<i class="fas ${secret.icon} text-${secret.color} text-2xl md:text-3xl"></i>
</div>
<h3 class="font-brush text-2xl md:text-3xl text-paper mb-2">${secret.name}</h3>
<p class="text-paper/60 text-sm md:text-base">${secret.desc}</p>
</div>
<div class="space-y-4 md:space-y-6">
${secret.quotes.map(q => `
<div class="quote-block">
<p class="text-paper/80 text-base md:text-lg leading-relaxed">「${q}」</p>
<p class="text-gold text-xs md:text-sm mt-2">——《抱朴子·内篇》</p>
</div>
`).join('')}
</div>
<div class="mt-6 md:mt-8 p-4 md:p-6 rounded-xl bg-ink/30 border border-jade/20">
<h4 class="text-jade font-brush text-lg md:text-xl mb-3 md:mb-4">推荐典籍</h4>
<div class="grid md:grid-cols-2 gap-3 md:gap-4">
${secret.books.map(book => `
<div class="p-3 rounded-lg bg-ink/30">
<div class="text-paper mb-1">${book.name}</div>
<div class="text-paper/50 text-xs md:text-sm">${book.desc}</div>
</div>
`).join('')}
</div>
</div>
`;
}

// 学习功法
function learnTechnique(name) {
// 查找功法数据
let techData = null;
for (const category of Object.values(techniqueData)) {
const found = category.find(t => t.name === name);
if (found) {
techData = found;
break;
}
}

if (!techData) return;

let content = `
<div class="space-y-4 md:space-y-6">
<div class="p-4 rounded-lg bg-ink/30">
<h4 class="text-gold text-sm md:text-base mb-2">功法口诀</h4>
<p class="text-paper/70 text-sm md:text-base leading-relaxed">${techData.mantra}</p>
</div>
<div class="p-4 rounded-lg bg-ink/30">
<h4 class="text-gold text-sm md:text-base mb-2">修炼要点</h4>
<ul class="text-paper/70 text-sm md:text-base space-y-2">
${techData.points.map(p => `<li>• ${p}</li>`).join('')}
</ul>
</div>
`;

// 如果有修炼周期
if (techData.cycle) {
content += `
<div class="p-4 rounded-lg bg-ink/30 border border-jade/20">
<h4 class="text-jade text-sm md:text-base mb-3">修炼周期</h4>
<div class="practice-log">
${techData.cycle.map(c => `
<div class="log-entry">
<div class="text-gold text-sm mb-1">${c.day}</div>
<div class="text-paper/70 text-sm mb-1">${c.content}</div>
<div class="text-jade text-xs">效果：${c.effect}</div>
</div>
`).join('')}
</div>
</div>
`;
}

content += `
<div class="flex gap-4">
<button class="btn-immortal flex-1 text-sm md:text-base" onclick="confirmLearnTechnique('${name}')">
<i class="fas fa-check mr-2"></i>开始修习
</button>
<button class="btn-immortal flex-1 text-sm md:text-base" onclick="closeLearnTechnique()">
<i class="fas fa-times mr-2"></i>取消
</button>
</div>
`;

document.getElementById('learnTechName').textContent = name;
document.getElementById('learnTechContent').innerHTML = content;
document.getElementById('learnTechniqueModal').classList.remove('hidden');
}

function closeLearnTechnique() {
document.getElementById('learnTechniqueModal').classList.add('hidden');
}

function confirmLearnTechnique(name) {
alert(`已开始修习「${name}」，请按照修炼周期每日按时修炼。`);
closeLearnTechnique();
}

// 生成丹药内容
function generateAlchemyContent() {
const container = document.getElementById('alchemyContent');
let html = '';

// 灵丹妙药
html += `<div class="tab-content active" data-content="dans">
<div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6">
${alchemyData.dans.map(dan => `
<div class="scroll-card">
<div class="flex items-center gap-3 mb-3 md:mb-4">
<div class="w-10 h-10 md:w-12 md:h-12 rounded-lg bg-${dan.color}/20 flex items-center justify-center">
<i class="fas fa-circle text-${dan.color} text-lg md:text-xl"></i>
</div>
<div>
<h4 class="font-brush text-lg md:text-xl text-paper">${dan.name}</h4>
<span class="text-${dan.color} text-xs md:text-sm">${dan.level}</span>
</div>
</div>
<p class="text-paper/70 mb-3 md:mb-4 text-sm md:text-base">${dan.desc}</p>
<div class="space-y-2 text-xs md:text-sm text-paper/60">
<div class="flex justify-between"><span>品阶</span><span class="text-${dan.color}">${dan.grade}</span></div>
<div class="flex justify-between"><span>功效</span><span>${dan.effect}</span></div>
<div class="flex justify-between"><span>市价</span><span>${dan.price}</span></div>
</div>
</div>
`).join('')}
</div>
</div>`;

// 天材地宝
html += `<div class="tab-content hidden" data-content="herbs">
<div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4 md:gap-6">
${alchemyData.herbs.map(herb => `
<div class="scroll-card">
<div class="flex items-center gap-3 mb-3 md:mb-4">
<div class="w-10 h-10 md:w-12 md:h-12 rounded-lg bg-${herb.color}/20 flex items-center justify-center">
<i class="fas fa-${herb.type === '灵植' ? 'leaf' : herb.type === '货币' ? 'gem' : herb.type === '灵果' ? 'apple-alt' : herb.type === '灵材' ? 'cube' : 'flask'} text-${herb.color} text-lg md:text-xl"></i>
</div>
<div>
<h4 class="font-brush text-lg md:text-xl text-paper">${herb.name}</h4>
<span class="text-${herb.color} text-xs md:text-sm">${herb.type}</span>
</div>
</div>
<p class="text-paper/70 mb-3 md:mb-4 text-sm md:text-base">${herb.desc}</p>
<div class="space-y-2 text-xs md:text-sm text-paper/60">
<div class="flex justify-between"><span>${herb.age ? '年份' : herb.grade ? '品阶' : '稀有度'}</span><span>${herb.age || herb.grade || herb.rarity}</span></div>
<div class="flex justify-between"><span>用途</span><span>${herb.use}</span></div>
</div>
</div>
`).join('')}
</div>
</div>`;

// 丹方秘录
html += `<div class="tab-content hidden" data-content="formulas">
<div class="glass-card p-6 md:p-8 max-w-4xl mx-auto">
<h3 class="font-brush text-xl md:text-2xl text-paper mb-4 md:mb-6 text-center">丹方秘录</h3>
<div class="space-y-4 md:space-y-6">
${alchemyData.formulas.map(formula => `
<div class="p-4 md:p-6 rounded-xl bg-ink/30 border border-${formula.color}/20">
<h4 class="text-${formula.color} font-brush text-lg md:text-xl mb-3">${formula.name}</h4>
<div class="grid md:grid-cols-2 gap-4">
<div>
<p class="text-paper/50 text-xs md:text-sm mb-2">所需材料：</p>
<ul class="text-paper/70 text-sm md:text-base space-y-1">
${formula.materials.map(m => `<li>• ${m}</li>`).join('')}
</ul>
</div>
<div>
<p class="text-paper/50 text-xs md:text-sm mb-2">炼制方法：</p>
<p class="text-paper/70 text-sm md:text-base">${formula.method}</p>
</div>
</div>
</div>
`).join('')}
</div>
</div>
</div>`;

container.innerHTML = html;
}

// 生成养生内容
function generateHealthContent() {
const container = document.getElementById('healthContent');
let html = '';

healthData.forEach(item => {
html += `
<div class="glass-card p-6 md:p-8 mb-6 md:mb-8">
<div class="flex flex-col md:flex-row items-start gap-6">
<div class="w-16 h-16 md:w-20 md:h-20 rounded-full bg-${item.color}/20 flex items-center justify-center flex-shrink-0 mx-auto md:mx-0">
<i class="fas fa-${item.icon} text-${item.color} text-2xl md:text-3xl"></i>
</div>
<div class="flex-grow text-center md:text-left">
<h3 class="font-brush text-xl md:text-2xl text-paper mb-3 md:mb-4">${item.title}</h3>
<p class="text-paper/70 mb-4 text-sm md:text-base">${item.desc}</p>
<div class="grid md:grid-cols-2 gap-4 mb-4">
<div class="p-4 rounded-lg bg-ink/30">
<h4 class="text-jade text-sm md:text-base mb-2">玄学解释</h4>
<p class="text-paper/60 text-xs md:text-sm">${item.xuanxue}</p>
</div>
<div class="p-4 rounded-lg bg-ink/30">
<h4 class="text-gold text-sm md:text-base mb-2">科学解释</h4>
<p class="text-paper/60 text-xs md:text-sm">${item.science}</p>
</div>
</div>
${item.elements ? `
<div class="grid grid-cols-5 gap-2 md:gap-3 mb-4">
${item.elements.map(el => `
<div class="text-center p-2 md:p-3 rounded-lg bg-ink/30">
<div class="text-${el.color} text-xs md:text-sm">${el.name}</div>
<div class="text-paper/50 text-xs">${el.element}行</div>
</div>
`).join('')}
</div>
` : ''}
<div class="p-4 rounded-lg bg-ink/30">
<h4 class="text-gold text-xs md:text-sm mb-2">养生要诀</h4>
<ul class="text-paper/60 text-xs md:text-sm space-y-1">
${item.tips.map(t => `<li>• ${t}</li>`).join('')}
</ul>
</div>
</div>
</div>
</div>
`;
});

// 每日修炼指标
html += `
<div class="glass-card p-6 md:p-8">
<h3 class="font-brush text-xl md:text-2xl text-paper mb-4 md:mb-6 text-center">每日修炼指标</h3>
<div class="grid md:grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6">
<div class="text-center p-4 md:p-6 rounded-xl bg-ink/30 border border-jade/20">
<div class="text-3xl md:text-4xl font-brush text-jade mb-2">7-8</div>
<div class="text-paper/70 text-sm md:text-base">时辰睡眠</div>
<div class="text-paper/50 text-xs mt-1">养阴蓄精</div>
</div>
<div class="text-center p-4 md:p-6 rounded-xl bg-ink/30 border border-gold/20">
<div class="text-3xl md:text-4xl font-brush text-gold mb-2">2000ml</div>
<div class="text-paper/70 text-sm md:text-base">饮水</div>
<div class="text-paper/50 text-xs mt-1">调和五行</div>
</div>
<div class="text-center p-4 md:p-6 rounded-xl bg-ink/30 border border-vermilion/20">
<div class="text-3xl md:text-4xl font-brush text-vermilion mb-2">30分</div>
<div class="text-paper/70 text-sm md:text-base">运动炼体</div>
<div class="text-paper/50 text-xs mt-1">升发阳气</div>
</div>
<div class="text-center p-4 md:p-6 rounded-xl bg-ink/30 border border-azure/20">
<div class="text-3xl md:text-4xl font-brush text-azure mb-2">1时辰</div>
<div class="text-paper/70 text-sm md:text-base">静心冥想</div>
<div class="text-paper/50 text-xs mt-1">凝神养气</div>
</div>
</div>
</div>
`;

container.innerHTML = html;
}

// 生成神仙列传
function generateLegendList() {
const container = document.getElementById('legendList');
let html = '';

legendData.forEach(legend => {
html += `
<div class="glass-card p-6 md:p-8">
<div class="flex items-start gap-4 md:gap-6">
<div class="w-16 h-16 md:w-20 md:h-20 rounded-full bg-${legend.color}/20 flex items-center justify-center flex-shrink-0">
<span class="font-brush text-2xl md:text-3xl text-${legend.color}">${legend.icon}</span>
</div>
<div>
<h3 class="font-brush text-xl md:text-2xl text-paper mb-2">${legend.name}</h3>
<p class="text-${legend.color} text-sm md:text-base mb-3">${legend.title}</p>
<p class="text-paper/70 text-sm md:text-base mb-4">${legend.desc}</p>
<div class="p-4 rounded-lg bg-ink/30 mb-4">
<p class="text-paper/60 text-xs md:text-sm">「${legend.quote}」</p>
</div>
<p class="text-paper/60 text-xs md:text-sm">${legend.story}</p>
</div>
</div>
</div>
`;
});

container.innerHTML = html;
}

// 生成每日任务
function generateDailyTasks() {
const tasks = [
{ name: '晨间吐纳', done: true },
{ name: '午时炼气', done: false },
{ name: '子时冥想', done: false },
{ name: '研读经典', done: false }
];

const container = document.getElementById('dailyTasks');
container.innerHTML = tasks.map(task => `
<div class="flex items-center justify-between p-2 md:p-3 rounded-lg bg-ink/30">
<div class="flex items-center gap-2 md:gap-3">
<i class="fas ${task.done ? 'fa-check-circle text-jade' : 'fa-circle text-paper/30'} text-sm md:text-base"></i>
<span class="text-paper/80 text-xs md:text-sm">${task.name}</span>
</div>
<span class="${task.done ? 'text-jade' : 'text-paper/50'} text-xs md:text-sm">${task.done ? '已完成' : '待完成'}</span>
</div>
`).join('');
}

// 生成修行记录
function generatePracticeLog() {
const logs = [
{ time: '今日 06:00', content: '完成晨间吐纳' },
{ time: '昨日 14:30', content: '修炼引气诀 2小时' },
{ time: '三日前', content: '突破至炼气三层' },
{ time: '五日前', content: '炼制聚气丹一枚' }
];

const container = document.getElementById('practiceLog');
container.innerHTML = logs.map(log => `
<div class="text-xs md:text-sm p-2 rounded bg-ink/20">
<div class="text-paper/80">${log.content}</div>
<div class="text-paper/40 text-xs">${log.time}</div>
</div>
`).join('');
}

// ==================== 冥想功能 ====================
function startMeditation() {
if (isMeditating) return;
isMeditating = true;
meditationSeconds = 0;

document.getElementById('meditationStatus').textContent = '冥想中...';
document.getElementById('meditationStatus').classList.remove('text-jade');
document.getElementById('meditationStatus').classList.add('text-gold');
document.getElementById('startMeditation').classList.add('opacity-50', 'cursor-not-allowed');
document.getElementById('startMeditation').disabled = true;
document.getElementById('stopMeditation').classList.remove('opacity-50', 'cursor-not-allowed');
document.getElementById('stopMeditation').disabled = false;

meditationTimer = setInterval(() => {
meditationSeconds++;
updateMeditationTimer();
}, 1000);
}

function updateMeditationTimer() {
const hours = Math.floor(meditationSeconds / 3600);
const minutes = Math.floor((meditationSeconds % 3600) / 60);
const seconds = meditationSeconds % 60;
document.getElementById('meditationTimer').textContent = 
`${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
}

function stopMeditation() {
if (!isMeditating) return;
isMeditating = false;
clearInterval(meditationTimer);

document.getElementById('meditationStatus').textContent = '待机中';
document.getElementById('meditationStatus').classList.remove('text-gold');
document.getElementById('meditationStatus').classList.add('text-jade');
document.getElementById('startMeditation').classList.remove('opacity-50', 'cursor-not-allowed');
document.getElementById('startMeditation').disabled = false;
document.getElementById('stopMeditation').classList.add('opacity-50', 'cursor-not-allowed');
document.getElementById('stopMeditation').disabled = true;

const hours = Math.floor(meditationSeconds / 3600);
const currentHours = parseInt(document.getElementById('practiceHours').textContent);
document.getElementById('practiceHours').textContent = currentHours + hours;

updatePracticeProgress(meditationSeconds);
}

function updatePracticeProgress(seconds) {
const currentProgress = parseInt(document.getElementById('practicePercent').textContent);
const gain = Math.floor(seconds / 60);
const newProgress = Math.min(currentProgress + gain, 100);

document.getElementById('practicePercent').textContent = newProgress + '%';
document.getElementById('practiceBar').style.width = newProgress + '%';

if (newProgress >= 100) {
showBreakthrough();
}
}

function showBreakthrough() {
const count = parseInt(document.getElementById('breakthroughCount').textContent);
document.getElementById('breakthroughCount').textContent = count + 1;
document.getElementById('practicePercent').textContent = '0%';
document.getElementById('practiceBar').style.width = '0%';

const icon = document.getElementById('currentRealmIcon');
icon.style.transform = 'scale(1.5)';
setTimeout(() => {
icon.style.transform = 'scale(1)';
}, 500);
}

// ==================== 灵根测试 ====================
function startRootTest() {
document.getElementById('rootTestModal').classList.remove('hidden');
showTestStep(1);
}

function showTestStep(step) {
document.querySelectorAll('.test-step').forEach(s => {
s.classList.add('hidden');
s.classList.remove('active');
});

if (step === 1) {
const content = `
<div class="test-step active" data-step="1">
<h3 class="font-brush text-xl md:text-2xl text-paper text-center mb-4 md:mb-6">灵根测试</h3>
<p class="text-paper/70 text-center mb-6 md:mb-8 text-sm md:text-base">灵根乃修行之根本，决定修行资质与属性。请静心回答以下问题。</p>
<div class="space-y-4">
<div>
<label class="text-paper/70 text-xs md:text-sm mb-2 block">你出生的时辰</label>
<select id="birthTime" class="input-immortal w-full text-sm md:text-base">
<option value="">请选择...</option>
<option value="zi">子时 (23:00-01:00)</option>
<option value="chou">丑时 (01:00-03:00)</option>
<option value="yin">寅时 (03:00-05:00)</option>
<option value="mao">卯时 (05:00-07:00)</option>
<option value="chen">辰时 (07:00-09:00)</option>
<option value="si">巳时 (09:00-11:00)</option>
<option value="wu">午时 (11:00-13:00)</option>
<option value="wei">未时 (13:00-15:00)</option>
<option value="shen">申时 (15:00-17:00)</option>
<option value="you">酉时 (17:00-19:00)</option>
<option value="xu">戌时 (19:00-21:00)</option>
<option value="hai">亥时 (21:00-23:00)</option>
</select>
</div>
<div>
<label class="text-paper/70 text-xs md:text-sm mb-2 block">你最喜欢的季节</label>
<select id="favoriteSeason" class="input-immortal w-full text-sm md:text-base">
<option value="">请选择...</option>
<option value="spring">春季</option>
<option value="summer">夏季</option>
<option value="autumn">秋季</option>
<option value="winter">冬季</option>
</select>
</div>
<button class="btn-immortal w-full mt-4 text-sm md:text-base" onclick="showTestStep(2)">
下一步
</button>
</div>
</div>
`;
document.getElementById('rootTestContent').innerHTML = content;
} else if (step === 2) {
const content = `
<div class="test-step active" data-step="2">
<h3 class="font-brush text-xl md:text-2xl text-paper text-center mb-4 md:mb-6">灵根测试</h3>
<p class="text-paper/70 text-center mb-6 md:mb-8 text-sm md:text-base">请选择与你最为契合的元素</p>
<div class="grid grid-cols-2 gap-3 md:gap-4">
<button class="p-4 md:p-6 rounded-xl border border-jade/30 hover:border-jade hover:bg-jade/10 transition-all" onclick="selectElement('wood')">
<i class="fas fa-leaf text-jade text-2xl md:text-3xl mb-2"></i>
<div class="text-paper text-sm md:text-base">木</div>
<div class="text-paper/50 text-xs md:text-sm">生机盎然</div>
</button>
<button class="p-4 md:p-6 rounded-xl border border-vermilion/30 hover:border-vermilion hover:bg-vermilion/10 transition-all" onclick="selectElement('fire')">
<i class="fas fa-fire text-vermilion text-2xl md:text-3xl mb-2"></i>
<div class="text-paper text-sm md:text-base">火</div>
<div class="text-paper/50 text-xs md:text-sm">炽热奔放</div>
</button>
<button class="p-4 md:p-6 rounded-xl border border-paper/30 hover:border-paper hover:bg-paper/10 transition-all" onclick="selectElement('metal')">
<i class="fas fa-gem text-paper/80 text-2xl md:text-3xl mb-2"></i>
<div class="text-paper text-sm md:text-base">金</div>
<div class="text-paper/50 text-xs md:text-sm">锋锐坚韧</div>
</button>
<button class="p-4 md:p-6 rounded-xl border border-spirit/30 hover:border-spirit hover:bg-spirit/10 transition-all" onclick="selectElement('water')">
<i class="fas fa-water text-spirit text-2xl md:text-3xl mb-2"></i>
<div class="text-paper text-sm md:text-base">水</div>
<div class="text-paper/50 text-xs md:text-sm">柔韧包容</div>
</button>
<button class="p-4 md:p-6 rounded-xl border border-gold/30 hover:border-gold hover:bg-gold/10 transition-all" onclick="selectElement('earth')">
<i class="fas fa-mountain text-gold text-2xl md:text-3xl mb-2"></i>
<div class="text-paper text-sm md:text-base">土</div>
<div class="text-paper/50 text-xs md:text-sm">厚重稳固</div>
</button>
<button class="p-4 md:p-6 rounded-xl border border-azure/30 hover:border-azure hover:bg-azure/10 transition-all" onclick="selectElement('balanced')">
<i class="fas fa-yin-yang text-azure text-2xl md:text-3xl mb-2"></i>
<div class="text-paper text-sm md:text-base">五行均衡</div>
<div class="text-paper/50 text-xs md:text-sm">中庸之道</div>
</button>
</div>
</div>
`;
document.getElementById('rootTestContent').innerHTML = content;
}
}

function selectElement(element) {
const rootTypes = {
wood: { name: '木灵根', level: '上品灵根', icon: 'fa-leaf', color: 'jade', bgClass: 'bg-jade/20', textClass: 'text-jade', desc: '木主生发，你的灵根属性偏向木行。修行木系功法事半功倍，治愈之术天赋异禀。', speed: '+30%', technique: '青木诀' },
fire: { name: '火灵根', level: '上品灵根', icon: 'fa-fire', color: 'vermilion', bgClass: 'bg-vermilion/20', textClass: 'text-vermilion', desc: '火主炽热，你的灵根属性偏向火行。修行火系功法事半功倍，炼丹之术天赋异禀。', speed: '+30%', technique: '烈焰诀' },
metal: { name: '金灵根', level: '上品灵根', icon: 'fa-gem', color: 'paper', bgClass: 'bg-paper/20', textClass: 'text-paper', desc: '金主锋锐，你的灵根属性偏向金行。修行金系功法事半功倍，剑道天赋异禀。', speed: '+30%', technique: '庚金诀' },
water: { name: '水灵根', level: '上品灵根', icon: 'fa-water', color: 'spirit', bgClass: 'bg-spirit/20', textClass: 'text-spirit', desc: '水主柔韧，你的灵根属性偏向水行。修行水系功法事半功倍，防御之术天赋异禀。', speed: '+30%', technique: '玄水诀' },
earth: { name: '土灵根', level: '上品灵根', icon: 'fa-mountain', color: 'gold', bgClass: 'bg-gold/20', textClass: 'text-gold', desc: '土主厚重，你的灵根属性偏向土行。修行土系功法事半功倍，防御之术天赋异禀。', speed: '+30%', technique: '厚土诀' },
balanced: { name: '五行灵根', level: '极品灵根', icon: 'fa-yin-yang', color: 'azure', bgClass: 'bg-azure/20', textClass: 'text-azure', desc: '五行均衡，你的灵根五行皆通。修行任何功法皆可，但需注意五行调和。', speed: '+20%', technique: '五行诀' }
};

const data = rootTypes[element];
if (!data) return;

const content = `
<div class="test-step active" data-step="result">
<div class="text-center">
<div class="w-20 h-20 md:w-24 md:h-24 mx-auto rounded-full mb-4 md:mb-6 flex items-center justify-center ${data.bgClass}">
<i class="fas ${data.icon} text-3xl md:text-4xl ${data.textClass}"></i>
</div>
<h3 class="font-brush text-2xl md:text-3xl text-paper mb-2">${data.name}</h3>
<p class="${data.textClass} text-base md:text-lg mb-4">${data.level}</p>
<p class="text-paper/70 mb-6 text-sm md:text-base">${data.desc}</p>
<div class="grid grid-cols-2 gap-3 md:gap-4 text-xs md:text-sm mb-6">
<div class="p-3 rounded-lg bg-ink/30">
<div class="text-paper/50 mb-1">修炼速度</div>
<div class="${data.textClass}">${data.speed}</div>
</div>
<div class="p-3 rounded-lg bg-ink/30">
<div class="text-paper/50 mb-1">推荐功法</div>
<div class="text-gold">${data.technique}</div>
</div>
</div>
<button class="btn-immortal w-full text-sm md:text-base" onclick="closeRootTest()">
<i class="fas fa-check mr-2"></i>确定
</button>
</div>
</div>
`;

document.getElementById('rootTestContent').innerHTML = content;
}

function closeRootTest() {
document.getElementById('rootTestModal').classList.add('hidden');
}

// ==================== 试炼场功能 ====================

// 反应测试
function startReactionGame() {
if (reactionGameState !== 'idle') return;
reactionGameState = 'waiting';
reactionTimes = [];

document.getElementById('reactionStatus').textContent = '等待灵光出现...';
document.getElementById('startReaction').disabled = true;
document.getElementById('startReaction').classList.add('opacity-50');
document.getElementById('stopReaction').disabled = false;
document.getElementById('stopReaction').classList.remove('opacity-50');

const delay = 2000 + Math.random() * 3000;
reactionTimeout = setTimeout(() => {
showReactionTarget();
}, delay);
}

function showReactionTarget() {
reactionGameState = 'active';
reactionStartTime = Date.now();

const gameArea = document.getElementById('reactionGame');
const target = document.getElementById('reactionTarget');

const maxX = gameArea.offsetWidth - 80;
const maxY = gameArea.offsetHeight - 80;
const x = Math.random() * maxX;
const y = Math.random() * maxY;

target.style.left = x + 'px';
target.style.top = y + 'px';
target.style.display = 'block';

document.getElementById('reactionStatus').textContent = '点击灵光！';

target.onclick = hitReactionTarget;
}

function hitReactionTarget() {
if (reactionGameState !== 'active') return;

const reactionTime = Date.now() - reactionStartTime;
reactionTimes.push(reactionTime);

const target = document.getElementById('reactionTarget');
target.style.display = 'none';

document.getElementById('reactionCount').textContent = reactionTimes.length;

const avg = Math.round(reactionTimes.reduce((a, b) => a + b, 0) / reactionTimes.length);
document.getElementById('avgReaction').textContent = avg + 'ms';

let rank = '凡人';
if (avg < 200) rank = '天神';
else if (avg < 300) rank = '真仙';
else if (avg < 400) rank = '金丹';
else if (avg < 500) rank = '筑基';
else if (avg < 600) rank = '炼气';
document.getElementById('reactionRank').textContent = rank;

if (reactionTimes.length < 5) {
reactionGameState = 'waiting';
document.getElementById('reactionStatus').textContent = '继续等待...';
const delay = 1500 + Math.random() * 2000;
reactionTimeout = setTimeout(() => {
showReactionTarget();
}, delay);
} else {
endReactionGame();
}
}

function stopReactionGame() {
clearTimeout(reactionTimeout);
endReactionGame();
}

function endReactionGame() {
reactionGameState = 'idle';
document.getElementById('reactionTarget').style.display = 'none';
document.getElementById('reactionStatus').textContent = reactionTimes.length >= 5 ? '测试完成！' : '测试已停止';
document.getElementById('startReaction').disabled = false;
document.getElementById('startReaction').classList.remove('opacity-50');
document.getElementById('stopReaction').disabled = true;
document.getElementById('stopReaction').classList.add('opacity-50');
}

// 定力测试
function startFocusGame() {
if (focusGameState !== 'idle') return;
focusGameState = 'active';
focusStartTime = Date.now();

document.getElementById('startFocus').disabled = true;
document.getElementById('startFocus').classList.add('opacity-50');
document.getElementById('stopFocus').disabled = false;
document.getElementById('stopFocus').classList.remove('opacity-50');

const target = document.getElementById('focusTarget');
target.style.transform = 'scale(1)';

focusTimer = setInterval(() => {
const elapsed = Math.floor((Date.now() - focusStartTime) / 1000);
document.getElementById('focusTime').textContent = elapsed + '秒';

if (elapsed > focusBestTime) {
focusBestTime = elapsed;
document.getElementById('focusBest').textContent = elapsed + '秒';
}

let rank = '凡人';
if (elapsed >= 120) rank = '天神';
else if (elapsed >= 90) rank = '真仙';
else if (elapsed >= 60) rank = '金丹';
else if (elapsed >= 30) rank = '筑基';
else if (elapsed >= 15) rank = '炼气';
document.getElementById('focusRank').textContent = rank;
}, 1000);

focusDistractionInterval = setInterval(() => {
addDistraction();
}, 800);

let scale = 1;
focusScaleInterval = setInterval(() => {
if (focusGameState !== 'active') return;
scale = Math.max(0.3, scale - 0.02);
target.style.transform = `scale(${scale})`;
}, 1000);

target.onclick = () => {
scale = Math.min(1, scale + 0.1);
target.style.transform = `scale(${scale})`;
};

document.getElementById('focusGame').onclick = (e) => {
if (e.target.id === 'focusGame') {
stopFocusGame();
}
};
}

function addDistraction() {
const container = document.getElementById('focusDistractions');
const distraction = document.createElement('div');

const types = ['文字', '光点', '波纹'];
const type = types[Math.floor(Math.random() * types.length)];

if (type === '文字') {
distraction.className = 'absolute text-paper/30 text-sm md:text-base animate-pulse';
distraction.textContent = ['心魔来袭', '杂念丛生', '欲望萌动', '恐惧滋生'][Math.floor(Math.random() * 4)];
} else if (type === '光点') {
distraction.className = 'absolute w-2 h-2 md:w-3 md:h-3 rounded-full bg-gold/50';
} else {
distraction.className = 'absolute w-8 h-8 md:w-12 md:h-12 rounded-full border border-paper/20';
}

distraction.style.left = Math.random() * 100 + '%';
distraction.style.top = Math.random() * 100 + '%';

container.appendChild(distraction);

setTimeout(() => {
distraction.remove();
}, 2000);
}

function stopFocusGame() {
focusGameState = 'idle';
clearInterval(focusTimer);
clearInterval(focusDistractionInterval);
clearInterval(focusScaleInterval);

document.getElementById('startFocus').disabled = false;
document.getElementById('startFocus').classList.remove('opacity-50');
document.getElementById('stopFocus').disabled = true;
document.getElementById('stopFocus').classList.add('opacity-50');
document.getElementById('focusDistractions').innerHTML = '';
}

// 记忆游戏
function generateMemoryCards() {
const container = document.getElementById('memoryGame');
const symbols = ['☯', '☰', '☱', '☲', '☳', '☴', '☵', '☶', '☷', '✧', '✦', '⋆', '✴', '❋', '✿'];
let html = '';

for (let i = 0; i < 16; i++) {
html += `<div class="memory-card" data-index="${i}"><i class="fas fa-question"></i></div>`;
}

container.innerHTML = html;
}

function startMemoryGame() {
if (memoryGameState !== 'idle') return;
memoryGameState = 'showing';
memorySequence = [];
memoryPlayerSequence = [];
memoryLevel = 1;

document.getElementById('startMemory').disabled = true;
document.getElementById('startMemory').classList.add('opacity-50');
document.getElementById('stopMemory').disabled = false;
document.getElementById('stopMemory').classList.remove('opacity-50');

nextMemoryRound();
}

function nextMemoryRound() {
memoryPlayerSequence = [];
memorySequence.push(Math.floor(Math.random() * 16));

document.getElementById('memoryLevel').textContent = memoryLevel;

let rank = '凡人';
if (memoryLevel >= 10) rank = '天神';
else if (memoryLevel >= 8) rank = '真仙';
else if (memoryLevel >= 6) rank = '金丹';
else if (memoryLevel >= 4) rank = '筑基';
else if (memoryLevel >= 2) rank = '炼气';
document.getElementById('memoryRank').textContent = rank;

// 显示序列
let i = 0;
memoryFlashInterval = setInterval(() => {
if (i >= memorySequence.length) {
clearInterval(memoryFlashInterval);
memoryGameState = 'input';
enableMemoryInput();
return;
}

const card = document.querySelector(`.memory-card[data-index="${memorySequence[i]}"]`);
card.classList.add('flipped');
card.innerHTML = '<i class="fas fa-yin-yang"></i>';

setTimeout(() => {
card.classList.remove('flipped');
card.innerHTML = '<i class="fas fa-question"></i>';
}, 500);

i++;
}, 800);
}

function enableMemoryInput() {
document.querySelectorAll('.memory-card').forEach(card => {
card.onclick = function() {
if (memoryGameState !== 'input') return;

const index = parseInt(this.dataset.index);
memoryPlayerSequence.push(index);

this.classList.add('flipped');
this.innerHTML = '<i class="fas fa-yin-yang"></i>';

setTimeout(() => {
this.classList.remove('flipped');
this.innerHTML = '<i class="fas fa-question"></i>';
}, 300);

// 检查是否正确
const currentIndex = memoryPlayerSequence.length - 1;
if (memoryPlayerSequence[currentIndex] !== memorySequence[currentIndex]) {
// 错误
stopMemoryGame();
alert(`记忆阵法破解失败！当前关卡：${memoryLevel}`);
return;
}

// 检查是否完成当前关卡
if (memoryPlayerSequence.length === memorySequence.length) {
memoryGameState = 'showing';
memoryLevel++;
if (memoryLevel > memoryBestLevel) {
memoryBestLevel = memoryLevel - 1;
document.getElementById('memoryBest').textContent = memoryBestLevel;
}
setTimeout(nextMemoryRound, 1000);
}
};
});
}

function stopMemoryGame() {
memoryGameState = 'idle';
clearInterval(memoryFlashInterval);

document.getElementById('startMemory').disabled = false;
document.getElementById('startMemory').classList.remove('opacity-50');
document.getElementById('stopMemory').disabled = true;
document.getElementById('stopMemory').classList.add('opacity-50');

document.querySelectorAll('.memory-card').forEach(card => {
card.classList.remove('flipped', 'matched');
card.innerHTML = '<i class="fas fa-question"></i>';
card.onclick = null;
});
}

// 悟性测试
function loadWisdomQuestion() {
const question = wisdomQuestions[wisdomCurrentQuestion];
document.getElementById('wisdomQuestion').textContent = '「' + question.question + '」';

const optionsHtml = question.options.map((opt, i) => `
<button class="w-full p-3 md:p-4 text-left rounded-lg bg-ink/30 border border-paper/10 hover:border-gold/30 transition-colors text-paper/70 text-sm md:text-base" onclick="checkWisdom(${i + 1})">
${String.fromCharCode(65 + i)}. ${opt}
</button>
`).join('');

document.getElementById('wisdomOptions').innerHTML = optionsHtml;
}

function checkWisdom(answer) {
const question = wisdomQuestions[wisdomCurrentQuestion];
const isCorrect = answer === question.correct;

wisdomTotalCount++;
if (isCorrect) wisdomCorrectCount++;

const correctRate = Math.round((wisdomCorrectCount / wisdomTotalCount) * 100);
document.getElementById('wisdomCount').textContent = wisdomTotalCount;
document.getElementById('wisdomCorrect').textContent = correctRate + '%';

let rank = '凡人';
if (correctRate >= 90) rank = '天神';
else if (correctRate >= 75) rank = '真仙';
else if (correctRate >= 60) rank = '金丹';
else if (correctRate >= 45) rank = '筑基';
else if (correctRate >= 30) rank = '炼气';
document.getElementById('wisdomRank').textContent = rank;

wisdomCurrentQuestion = (wisdomCurrentQuestion + 1) % wisdomQuestions.length;
loadWisdomQuestion();
}

// 显示境界信息
function showRealmInfo() {
showRealmDetail('lianqi');
}
</script>
</body>
</html>
